=== Running mpiexec -n 4 /home/thhoens/cntk/build/gpu/release/bin/cntk configFile=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.cntk currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/ OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu DeviceId=-1 timestamping=true numCPUThreads=5 stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
-------------------------------------------------------------------
Build info: 

		Built time: Apr  5 2016 16:12:58
		Last modified date: Mon Apr  4 19:29:14 2016
		Build type: release
		Build target: GPU
		With 1bit-SGD: no
		Math lib: acml
		CUDA_PATH: /usr/local/cuda-7.0
		CUB_PATH: /usr/local/cub-1.4.1
		CUDNN_PATH: /usr/local/cudnn-4.0
		Build Branch: thhoens/matrixmerge
		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
		Built by REDMOND.thhoens on GCRGPUDEV029
		Build Path: /home/thhoens/cntk
-------------------------------------------------------------------
Changed current directory to /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPIWrapper: initializing MPI
-------------------------------------------------------------------
Build info: 

		Built time: Apr  5 2016 16:12:58
		Last modified date: Mon Apr  4 19:29:14 2016
		Build type: release
		Build target: GPU
		With 1bit-SGD: no
		Math lib: acml
		CUDA_PATH: /usr/local/cuda-7.0
		CUB_PATH: /usr/local/cub-1.4.1
		CUDNN_PATH: /usr/local/cudnn-4.0
		Build Branch: thhoens/matrixmerge
		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
		Built by REDMOND.thhoens on GCRGPUDEV029
		Build Path: /home/thhoens/cntk
-------------------------------------------------------------------
Changed current directory to /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPIWrapper: initializing MPI
-------------------------------------------------------------------
Build info: 

		Built time: Apr  5 2016 16:12:58
		Last modified date: Mon Apr  4 19:29:14 2016
		Build type: release
		Build target: GPU
		With 1bit-SGD: no
		Math lib: acml
		CUDA_PATH: /usr/local/cuda-7.0
		CUB_PATH: /usr/local/cub-1.4.1
		CUDNN_PATH: /usr/local/cudnn-4.0
		Build Branch: thhoens/matrixmerge
		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
		Built by REDMOND.thhoens on GCRGPUDEV029
		Build Path: /home/thhoens/cntk
-------------------------------------------------------------------
Changed current directory to /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPIWrapper: initializing MPI
-------------------------------------------------------------------
Build info: 

		Built time: Apr  5 2016 16:12:58
		Last modified date: Mon Apr  4 19:29:14 2016
		Build type: release
		Build target: GPU
		With 1bit-SGD: no
		Math lib: acml
		CUDA_PATH: /usr/local/cuda-7.0
		CUB_PATH: /usr/local/cub-1.4.1
		CUDNN_PATH: /usr/local/cudnn-4.0
		Build Branch: thhoens/matrixmerge
		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
		Built by REDMOND.thhoens on GCRGPUDEV029
		Build Path: /home/thhoens/cntk
-------------------------------------------------------------------
Changed current directory to /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPIWrapper: initializing MPI
ping [requestnodes (before change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: all 4 nodes responded
requestnodes [MPIWrapper]: using 4 out of 4 MPI nodes (4 requested); we (2) are in (participating)
ping [requestnodes (after change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: all 4 nodes responded
requestnodes [MPIWrapper]: using 4 out of 4 MPI nodes (4 requested); we (0) are in (participating)
ping [requestnodes (after change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: all 4 nodes responded
requestnodes [MPIWrapper]: using 4 out of 4 MPI nodes (4 requested); we (3) are in (participating)
ping [requestnodes (after change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: all 4 nodes responded
requestnodes [MPIWrapper]: using 4 out of 4 MPI nodes (4 requested); we (1) are in (participating)
ping [requestnodes (after change)]: 4 nodes pinging each other
ping [requestnodes (after change)]: all 4 nodes responded
mpihelper: we are cog 0 in a gearbox of 4
ping [mpihelper]: 4 nodes pinging each other
ping [requestnodes (after change)]: all 4 nodes responded
mpihelper: we are cog 2 in a gearbox of 4
ping [mpihelper]: 4 nodes pinging each other
ping [requestnodes (after change)]: all 4 nodes responded
mpihelper: we are cog 1 in a gearbox of 4
ping [mpihelper]: 4 nodes pinging each other
ping [requestnodes (after change)]: all 4 nodes responded
mpihelper: we are cog 3 in a gearbox of 4
ping [mpihelper]: 4 nodes pinging each other
ping [mpihelper]: all 4 nodes responded
ping [mpihelper]: all 4 nodes responded
ping [mpihelper]: all 4 nodes responded
ping [mpihelper]: all 4 nodes responded
04/05/2016 16:23:45: Redirecting stderr to file /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr_train.logrank0
04/05/2016 16:23:46: Redirecting stderr to file /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr_train.logrank1
04/05/2016 16:23:46: Redirecting stderr to file /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr_train.logrank2
04/05/2016 16:23:47: Redirecting stderr to file /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr_train.logrank3
MPI Rank 0: 04/05/2016 16:23:45: -------------------------------------------------------------------
MPI Rank 0: 04/05/2016 16:23:45: Build info: 
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:45: 		Built time: Apr  5 2016 16:12:58
MPI Rank 0: 04/05/2016 16:23:45: 		Last modified date: Mon Apr  4 19:29:14 2016
MPI Rank 0: 04/05/2016 16:23:45: 		Build type: release
MPI Rank 0: 04/05/2016 16:23:45: 		Build target: GPU
MPI Rank 0: 04/05/2016 16:23:45: 		With 1bit-SGD: no
MPI Rank 0: 04/05/2016 16:23:45: 		Math lib: acml
MPI Rank 0: 04/05/2016 16:23:45: 		CUDA_PATH: /usr/local/cuda-7.0
MPI Rank 0: 04/05/2016 16:23:45: 		CUB_PATH: /usr/local/cub-1.4.1
MPI Rank 0: 04/05/2016 16:23:45: 		CUDNN_PATH: /usr/local/cudnn-4.0
MPI Rank 0: 04/05/2016 16:23:45: 		Build Branch: thhoens/matrixmerge
MPI Rank 0: 04/05/2016 16:23:45: 		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
MPI Rank 0: 04/05/2016 16:23:45: 		Built by REDMOND.thhoens on GCRGPUDEV029
MPI Rank 0: 04/05/2016 16:23:45: 		Build Path: /home/thhoens/cntk
MPI Rank 0: 04/05/2016 16:23:45: -------------------------------------------------------------------
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:45: Running on localhost at 2016/04/05 16:23:45
MPI Rank 0: 04/05/2016 16:23:45: Command line: 
MPI Rank 0: /home/thhoens/cntk/build/gpu/release/bin/cntk  configFile=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.cntk  currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/  OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DeviceId=-1  timestamping=true  numCPUThreads=5  stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 0: 
MPI Rank 0: 
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:45: >>>>>>>>>>>>>>>>>>>> RAW CONFIG (VARIABLES NOT RESOLVED) >>>>>>>>>>>>>>>>>>>>
MPI Rank 0: 04/05/2016 16:23:45: modelPath=$RunDir$/Models/dssm.net
MPI Rank 0: MBSize=4096
MPI Rank 0: LRate=0.0001
MPI Rank 0: DeviceId=-1
MPI Rank 0: parallelTrain=true
MPI Rank 0: command = train
MPI Rank 0: precision = float
MPI Rank 0: traceGPUMemoryAllocations=0
MPI Rank 0: train = [
MPI Rank 0:     action = train
MPI Rank 0:     numMBsToShowResult=10
MPI Rank 0:     deviceId=$DeviceId$
MPI Rank 0:     minibatchSize = $MBSize$
MPI Rank 0:     modelPath = $modelPath$
MPI Rank 0:     traceLevel = 1
MPI Rank 0:     SGD = [
MPI Rank 0:         epochSize=102399
MPI Rank 0:         learningRatesPerSample = $LRate$
MPI Rank 0:         momentumPerMB = 0.9
MPI Rank 0:         maxEpochs=3
MPI Rank 0:         ParallelTrain=[
MPI Rank 0:             parallelizationStartEpoch=1
MPI Rank 0:             parallelizationMethod=ModelAveragingSGD
MPI Rank 0:             distributedMBReading=true
MPI Rank 0:             ModelAveragingSGD=[
MPI Rank 0:                 SyncFrequencyInFrames=1024
MPI Rank 0:             ]
MPI Rank 0:         ]
MPI Rank 0: 		gradUpdateType=none
MPI Rank 0: 		gradientClippingWithTruncation=true
MPI Rank 0: 		clippingThresholdPerSample=1#INF
MPI Rank 0:     ]
MPI Rank 0: ]
MPI Rank 0: NDLNetworkBuilder = [
MPI Rank 0:     networkDescription = $ConfigDir$/dssm.ndl
MPI Rank 0: ]
MPI Rank 0: reader = [
MPI Rank 0:     readerType = LibSVMBinaryReader
MPI Rank 0:     miniBatchMode = Partial
MPI Rank 0:     randomize = 0
MPI Rank 0:     file = $DataDir$/train.all.bin
MPI Rank 0: ]
MPI Rank 0: cvReader = [
MPI Rank 0:     readerType = LibSVMBinaryReader
MPI Rank 0:     miniBatchMode = Partial
MPI Rank 0:     randomize = 0
MPI Rank 0:     file = $DataDir$/train.all.bin
MPI Rank 0: ]
MPI Rank 0: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 0: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 0: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 0: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 0: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 0: DeviceId=-1
MPI Rank 0: timestamping=true
MPI Rank 0: numCPUThreads=5
MPI Rank 0: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:45: <<<<<<<<<<<<<<<<<<<< RAW CONFIG (VARIABLES NOT RESOLVED)  <<<<<<<<<<<<<<<<<<<<
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:45: >>>>>>>>>>>>>>>>>>>> RAW CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 0: 04/05/2016 16:23:45: modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 0: MBSize=4096
MPI Rank 0: LRate=0.0001
MPI Rank 0: DeviceId=-1
MPI Rank 0: parallelTrain=true
MPI Rank 0: command = train
MPI Rank 0: precision = float
MPI Rank 0: traceGPUMemoryAllocations=0
MPI Rank 0: train = [
MPI Rank 0:     action = train
MPI Rank 0:     numMBsToShowResult=10
MPI Rank 0:     deviceId=-1
MPI Rank 0:     minibatchSize = 4096
MPI Rank 0:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 0:     traceLevel = 1
MPI Rank 0:     SGD = [
MPI Rank 0:         epochSize=102399
MPI Rank 0:         learningRatesPerSample = 0.0001
MPI Rank 0:         momentumPerMB = 0.9
MPI Rank 0:         maxEpochs=3
MPI Rank 0:         ParallelTrain=[
MPI Rank 0:             parallelizationStartEpoch=1
MPI Rank 0:             parallelizationMethod=ModelAveragingSGD
MPI Rank 0:             distributedMBReading=true
MPI Rank 0:             ModelAveragingSGD=[
MPI Rank 0:                 SyncFrequencyInFrames=1024
MPI Rank 0:             ]
MPI Rank 0:         ]
MPI Rank 0: 		gradUpdateType=none
MPI Rank 0: 		gradientClippingWithTruncation=true
MPI Rank 0: 		clippingThresholdPerSample=1#INF
MPI Rank 0:     ]
MPI Rank 0: ]
MPI Rank 0: NDLNetworkBuilder = [
MPI Rank 0:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 0: ]
MPI Rank 0: reader = [
MPI Rank 0:     readerType = LibSVMBinaryReader
MPI Rank 0:     miniBatchMode = Partial
MPI Rank 0:     randomize = 0
MPI Rank 0:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 0: ]
MPI Rank 0: cvReader = [
MPI Rank 0:     readerType = LibSVMBinaryReader
MPI Rank 0:     miniBatchMode = Partial
MPI Rank 0:     randomize = 0
MPI Rank 0:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 0: ]
MPI Rank 0: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 0: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 0: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 0: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 0: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 0: DeviceId=-1
MPI Rank 0: timestamping=true
MPI Rank 0: numCPUThreads=5
MPI Rank 0: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:45: <<<<<<<<<<<<<<<<<<<< RAW CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:45: >>>>>>>>>>>>>>>>>>>> PROCESSED CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 0: configparameters: dssm.cntk:command=train
MPI Rank 0: configparameters: dssm.cntk:ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 0: configparameters: dssm.cntk:currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 0: configparameters: dssm.cntk:cvReader=[
MPI Rank 0:     readerType = LibSVMBinaryReader
MPI Rank 0:     miniBatchMode = Partial
MPI Rank 0:     randomize = 0
MPI Rank 0:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 0: ]
MPI Rank 0: 
MPI Rank 0: configparameters: dssm.cntk:DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 0: configparameters: dssm.cntk:DeviceId=-1
MPI Rank 0: configparameters: dssm.cntk:LRate=0.0001
MPI Rank 0: configparameters: dssm.cntk:MBSize=4096
MPI Rank 0: configparameters: dssm.cntk:modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 0: configparameters: dssm.cntk:NDLNetworkBuilder=[
MPI Rank 0:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 0: ]
MPI Rank 0: 
MPI Rank 0: configparameters: dssm.cntk:numCPUThreads=5
MPI Rank 0: configparameters: dssm.cntk:OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 0: configparameters: dssm.cntk:parallelTrain=true
MPI Rank 0: configparameters: dssm.cntk:precision=float
MPI Rank 0: configparameters: dssm.cntk:reader=[
MPI Rank 0:     readerType = LibSVMBinaryReader
MPI Rank 0:     miniBatchMode = Partial
MPI Rank 0:     randomize = 0
MPI Rank 0:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 0: ]
MPI Rank 0: 
MPI Rank 0: configparameters: dssm.cntk:RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 0: configparameters: dssm.cntk:stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 0: configparameters: dssm.cntk:timestamping=true
MPI Rank 0: configparameters: dssm.cntk:traceGPUMemoryAllocations=0
MPI Rank 0: configparameters: dssm.cntk:train=[
MPI Rank 0:     action = train
MPI Rank 0:     numMBsToShowResult=10
MPI Rank 0:     deviceId=-1
MPI Rank 0:     minibatchSize = 4096
MPI Rank 0:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 0:     traceLevel = 1
MPI Rank 0:     SGD = [
MPI Rank 0:         epochSize=102399
MPI Rank 0:         learningRatesPerSample = 0.0001
MPI Rank 0:         momentumPerMB = 0.9
MPI Rank 0:         maxEpochs=3
MPI Rank 0:         ParallelTrain=[
MPI Rank 0:             parallelizationStartEpoch=1
MPI Rank 0:             parallelizationMethod=ModelAveragingSGD
MPI Rank 0:             distributedMBReading=true
MPI Rank 0:             ModelAveragingSGD=[
MPI Rank 0:                 SyncFrequencyInFrames=1024
MPI Rank 0:             ]
MPI Rank 0:         ]
MPI Rank 0: 		gradUpdateType=none
MPI Rank 0: 		gradientClippingWithTruncation=true
MPI Rank 0: 		clippingThresholdPerSample=1#INF
MPI Rank 0:     ]
MPI Rank 0: ]
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:45: <<<<<<<<<<<<<<<<<<<< PROCESSED CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 0: 04/05/2016 16:23:45: Commands: train
MPI Rank 0: 04/05/2016 16:23:45: Precision = "float"
MPI Rank 0: 04/05/2016 16:23:45: Using 5 CPU threads.
MPI Rank 0: 04/05/2016 16:23:45: CNTKModelPath: /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 0: 04/05/2016 16:23:45: CNTKCommandTrainInfo: train : 3
MPI Rank 0: 04/05/2016 16:23:45: CNTKCommandTrainInfo: CNTKNoMoreCommands_Total : 3
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:45: ##############################################################################
MPI Rank 0: 04/05/2016 16:23:45: #                                                                            #
MPI Rank 0: 04/05/2016 16:23:45: # Action "train"                                                             #
MPI Rank 0: 04/05/2016 16:23:45: #                                                                            #
MPI Rank 0: 04/05/2016 16:23:45: ##############################################################################
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:45: CNTKCommandTrainBegin: train
MPI Rank 0: NDLBuilder Using CPU
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:45: Creating virgin network.
MPI Rank 0: 
MPI Rank 0: Post-processing network...
MPI Rank 0: 
MPI Rank 0: 2 roots:
MPI Rank 0: 	CE = CrossEntropyWithSoftmax()
MPI Rank 0: 	SIM = CosDistanceWithNegativeSamples()
MPI Rank 0: 
MPI Rank 0: Validating network. 21 nodes to process in pass 1.
MPI Rank 0: 
MPI Rank 0: 
MPI Rank 0: Validating network. 11 nodes to process in pass 2.
MPI Rank 0: 
MPI Rank 0: 
MPI Rank 0: Validating network, final pass.
MPI Rank 0: 
MPI Rank 0: Validating --> DSSMLabel = InputValue() :  -> [51 x 1 x *]
MPI Rank 0: Validating --> G = LearnableParameter() :  -> [1 x 1]
MPI Rank 0: Validating --> WQ1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 0: Validating --> WQ0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 0: Validating --> Query = SparseInputValue() :  -> [49292 x *]
MPI Rank 0: Validating --> WQ0_Q = Times (WQ0, Query) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 0: Validating --> WQ0_Q_Tanh = Tanh (WQ0_Q) : [288 x *] -> [288 x *]
MPI Rank 0: Validating --> WQ1_Q = Times (WQ1, WQ0_Q_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 0: Validating --> WQ1_Q_Tanh = Tanh (WQ1_Q) : [64 x *] -> [64 x *]
MPI Rank 0: Validating --> WD1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 0: Validating --> WD0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 0: Validating --> Keyword = SparseInputValue() :  -> [49292 x *]
MPI Rank 0: Validating --> WD0_D = Times (WD0, Keyword) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 0: Validating --> WD0_D_Tanh = Tanh (WD0_D) : [288 x *] -> [288 x *]
MPI Rank 0: Validating --> WD1_D = Times (WD1, WD0_D_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 0: Validating --> WD1_D_Tanh = Tanh (WD1_D) : [64 x *] -> [64 x *]
MPI Rank 0: Validating --> S = LearnableParameter() :  -> [1 x 1]
MPI Rank 0: Validating --> N = LearnableParameter() :  -> [1 x 1]
MPI Rank 0: Validating --> SIM = CosDistanceWithNegativeSamples (WQ1_Q_Tanh, WD1_D_Tanh, S, N) : [64 x *], [64 x *], [1 x 1], [1 x 1] -> [51 x *]
MPI Rank 0: Validating --> SIM_Scale = ElementTimes (G, SIM) : [1 x 1], [51 x *] -> [51 x 1 x *]
MPI Rank 0: Validating --> CE = CrossEntropyWithSoftmax (DSSMLabel, SIM_Scale) : [51 x 1 x *], [51 x 1 x *] -> [1]
MPI Rank 0: 
MPI Rank 0: 
MPI Rank 0: 8 out of 21 nodes do not share the minibatch layout with the input data.
MPI Rank 0: 
MPI Rank 0: Post-processing network complete.
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:46: Created model with 21 nodes on CPU.
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:46: Training criterion node(s):
MPI Rank 0: 04/05/2016 16:23:46: 	CE = CrossEntropyWithSoftmax
MPI Rank 0: 
MPI Rank 0: 
MPI Rank 0: Allocating matrices for forward and/or backward propagation.
MPI Rank 0: 04/05/2016 16:23:46: No PreCompute nodes found, skipping PreCompute step.
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:49: Starting Epoch 1: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:23:49: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 0: 04/05/2016 16:23:56:  Epoch[ 1 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  3.44191360; TotalTime = 6.9711s; SamplesPerSecond = 1468.9
MPI Rank 0: 04/05/2016 16:24:02:  Epoch[ 1 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  2.68707848; TotalTime = 6.3379s; SamplesPerSecond = 1615.7
MPI Rank 0: 04/05/2016 16:24:05: Finished Epoch[ 1 of 3]: [Training Set] TrainLossPerSample = 2.9191892; TotalSamplesSeen = 102399; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=16.3588
MPI Rank 0: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 2.138047    Perplexity = 8.4828547    
MPI Rank 0: 04/05/2016 16:24:15: Finished Epoch[ 1 of 3]: [Validation Set] TrainLossPerSample = 2.138047
MPI Rank 0: 04/05/2016 16:24:16: SGD: Saving checkpoint model '/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net.1'
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:24:18: Starting Epoch 2: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:24:18: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 0: 04/05/2016 16:24:24:  Epoch[ 2 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.99931793; TotalTime = 6.1032s; SamplesPerSecond = 1677.8
MPI Rank 0: 04/05/2016 16:24:30:  Epoch[ 2 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.89505386; TotalTime = 5.8779s; SamplesPerSecond = 1742.1
MPI Rank 0: 04/05/2016 16:24:33: Finished Epoch[ 2 of 3]: [Training Set] TrainLossPerSample = 1.9437951; TotalSamplesSeen = 204798; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=14.9729
MPI Rank 0: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 1.8155899    Perplexity = 6.1447001    
MPI Rank 0: 04/05/2016 16:24:43: Finished Epoch[ 2 of 3]: [Validation Set] TrainLossPerSample = 1.8155899
MPI Rank 0: 04/05/2016 16:24:44: SGD: Saving checkpoint model '/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net.2'
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:24:46: Starting Epoch 3: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:24:46: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 0: 04/05/2016 16:24:52:  Epoch[ 3 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.75707302; TotalTime = 5.7661s; SamplesPerSecond = 1775.9
MPI Rank 0: 04/05/2016 16:24:57:  Epoch[ 3 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.74772396; TotalTime = 5.8526s; SamplesPerSecond = 1749.7
MPI Rank 0: 04/05/2016 16:25:01: Finished Epoch[ 3 of 3]: [Training Set] TrainLossPerSample = 1.7563989; TotalSamplesSeen = 307197; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=14.8007
MPI Rank 0: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 1.6991001    Perplexity = 5.4690234    
MPI Rank 0: 04/05/2016 16:25:11: Finished Epoch[ 3 of 3]: [Validation Set] TrainLossPerSample = 1.6991001
MPI Rank 0: 04/05/2016 16:25:12: SGD: Saving checkpoint model '/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net'
MPI Rank 0: 04/05/2016 16:25:13: CNTKCommandTrainEnd: train
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:13: Action "train" complete.
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:13: __COMPLETED__
MPI Rank 0: ~MPIWrapper
MPI Rank 1: 04/05/2016 16:23:46: -------------------------------------------------------------------
MPI Rank 1: 04/05/2016 16:23:46: Build info: 
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: 		Built time: Apr  5 2016 16:12:58
MPI Rank 1: 04/05/2016 16:23:46: 		Last modified date: Mon Apr  4 19:29:14 2016
MPI Rank 1: 04/05/2016 16:23:46: 		Build type: release
MPI Rank 1: 04/05/2016 16:23:46: 		Build target: GPU
MPI Rank 1: 04/05/2016 16:23:46: 		With 1bit-SGD: no
MPI Rank 1: 04/05/2016 16:23:46: 		Math lib: acml
MPI Rank 1: 04/05/2016 16:23:46: 		CUDA_PATH: /usr/local/cuda-7.0
MPI Rank 1: 04/05/2016 16:23:46: 		CUB_PATH: /usr/local/cub-1.4.1
MPI Rank 1: 04/05/2016 16:23:46: 		CUDNN_PATH: /usr/local/cudnn-4.0
MPI Rank 1: 04/05/2016 16:23:46: 		Build Branch: thhoens/matrixmerge
MPI Rank 1: 04/05/2016 16:23:46: 		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
MPI Rank 1: 04/05/2016 16:23:46: 		Built by REDMOND.thhoens on GCRGPUDEV029
MPI Rank 1: 04/05/2016 16:23:46: 		Build Path: /home/thhoens/cntk
MPI Rank 1: 04/05/2016 16:23:46: -------------------------------------------------------------------
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: Running on localhost at 2016/04/05 16:23:46
MPI Rank 1: 04/05/2016 16:23:46: Command line: 
MPI Rank 1: /home/thhoens/cntk/build/gpu/release/bin/cntk  configFile=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.cntk  currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/  OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DeviceId=-1  timestamping=true  numCPUThreads=5  stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 1: 
MPI Rank 1: 
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: >>>>>>>>>>>>>>>>>>>> RAW CONFIG (VARIABLES NOT RESOLVED) >>>>>>>>>>>>>>>>>>>>
MPI Rank 1: 04/05/2016 16:23:46: modelPath=$RunDir$/Models/dssm.net
MPI Rank 1: MBSize=4096
MPI Rank 1: LRate=0.0001
MPI Rank 1: DeviceId=-1
MPI Rank 1: parallelTrain=true
MPI Rank 1: command = train
MPI Rank 1: precision = float
MPI Rank 1: traceGPUMemoryAllocations=0
MPI Rank 1: train = [
MPI Rank 1:     action = train
MPI Rank 1:     numMBsToShowResult=10
MPI Rank 1:     deviceId=$DeviceId$
MPI Rank 1:     minibatchSize = $MBSize$
MPI Rank 1:     modelPath = $modelPath$
MPI Rank 1:     traceLevel = 1
MPI Rank 1:     SGD = [
MPI Rank 1:         epochSize=102399
MPI Rank 1:         learningRatesPerSample = $LRate$
MPI Rank 1:         momentumPerMB = 0.9
MPI Rank 1:         maxEpochs=3
MPI Rank 1:         ParallelTrain=[
MPI Rank 1:             parallelizationStartEpoch=1
MPI Rank 1:             parallelizationMethod=ModelAveragingSGD
MPI Rank 1:             distributedMBReading=true
MPI Rank 1:             ModelAveragingSGD=[
MPI Rank 1:                 SyncFrequencyInFrames=1024
MPI Rank 1:             ]
MPI Rank 1:         ]
MPI Rank 1: 		gradUpdateType=none
MPI Rank 1: 		gradientClippingWithTruncation=true
MPI Rank 1: 		clippingThresholdPerSample=1#INF
MPI Rank 1:     ]
MPI Rank 1: ]
MPI Rank 1: NDLNetworkBuilder = [
MPI Rank 1:     networkDescription = $ConfigDir$/dssm.ndl
MPI Rank 1: ]
MPI Rank 1: reader = [
MPI Rank 1:     readerType = LibSVMBinaryReader
MPI Rank 1:     miniBatchMode = Partial
MPI Rank 1:     randomize = 0
MPI Rank 1:     file = $DataDir$/train.all.bin
MPI Rank 1: ]
MPI Rank 1: cvReader = [
MPI Rank 1:     readerType = LibSVMBinaryReader
MPI Rank 1:     miniBatchMode = Partial
MPI Rank 1:     randomize = 0
MPI Rank 1:     file = $DataDir$/train.all.bin
MPI Rank 1: ]
MPI Rank 1: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 1: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 1: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 1: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 1: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 1: DeviceId=-1
MPI Rank 1: timestamping=true
MPI Rank 1: numCPUThreads=5
MPI Rank 1: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: <<<<<<<<<<<<<<<<<<<< RAW CONFIG (VARIABLES NOT RESOLVED)  <<<<<<<<<<<<<<<<<<<<
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: >>>>>>>>>>>>>>>>>>>> RAW CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 1: 04/05/2016 16:23:46: modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 1: MBSize=4096
MPI Rank 1: LRate=0.0001
MPI Rank 1: DeviceId=-1
MPI Rank 1: parallelTrain=true
MPI Rank 1: command = train
MPI Rank 1: precision = float
MPI Rank 1: traceGPUMemoryAllocations=0
MPI Rank 1: train = [
MPI Rank 1:     action = train
MPI Rank 1:     numMBsToShowResult=10
MPI Rank 1:     deviceId=-1
MPI Rank 1:     minibatchSize = 4096
MPI Rank 1:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 1:     traceLevel = 1
MPI Rank 1:     SGD = [
MPI Rank 1:         epochSize=102399
MPI Rank 1:         learningRatesPerSample = 0.0001
MPI Rank 1:         momentumPerMB = 0.9
MPI Rank 1:         maxEpochs=3
MPI Rank 1:         ParallelTrain=[
MPI Rank 1:             parallelizationStartEpoch=1
MPI Rank 1:             parallelizationMethod=ModelAveragingSGD
MPI Rank 1:             distributedMBReading=true
MPI Rank 1:             ModelAveragingSGD=[
MPI Rank 1:                 SyncFrequencyInFrames=1024
MPI Rank 1:             ]
MPI Rank 1:         ]
MPI Rank 1: 		gradUpdateType=none
MPI Rank 1: 		gradientClippingWithTruncation=true
MPI Rank 1: 		clippingThresholdPerSample=1#INF
MPI Rank 1:     ]
MPI Rank 1: ]
MPI Rank 1: NDLNetworkBuilder = [
MPI Rank 1:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 1: ]
MPI Rank 1: reader = [
MPI Rank 1:     readerType = LibSVMBinaryReader
MPI Rank 1:     miniBatchMode = Partial
MPI Rank 1:     randomize = 0
MPI Rank 1:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 1: ]
MPI Rank 1: cvReader = [
MPI Rank 1:     readerType = LibSVMBinaryReader
MPI Rank 1:     miniBatchMode = Partial
MPI Rank 1:     randomize = 0
MPI Rank 1:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 1: ]
MPI Rank 1: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 1: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 1: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 1: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 1: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 1: DeviceId=-1
MPI Rank 1: timestamping=true
MPI Rank 1: numCPUThreads=5
MPI Rank 1: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: <<<<<<<<<<<<<<<<<<<< RAW CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: >>>>>>>>>>>>>>>>>>>> PROCESSED CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 1: configparameters: dssm.cntk:command=train
MPI Rank 1: configparameters: dssm.cntk:ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 1: configparameters: dssm.cntk:currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 1: configparameters: dssm.cntk:cvReader=[
MPI Rank 1:     readerType = LibSVMBinaryReader
MPI Rank 1:     miniBatchMode = Partial
MPI Rank 1:     randomize = 0
MPI Rank 1:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 1: ]
MPI Rank 1: 
MPI Rank 1: configparameters: dssm.cntk:DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 1: configparameters: dssm.cntk:DeviceId=-1
MPI Rank 1: configparameters: dssm.cntk:LRate=0.0001
MPI Rank 1: configparameters: dssm.cntk:MBSize=4096
MPI Rank 1: configparameters: dssm.cntk:modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 1: configparameters: dssm.cntk:NDLNetworkBuilder=[
MPI Rank 1:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 1: ]
MPI Rank 1: 
MPI Rank 1: configparameters: dssm.cntk:numCPUThreads=5
MPI Rank 1: configparameters: dssm.cntk:OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 1: configparameters: dssm.cntk:parallelTrain=true
MPI Rank 1: configparameters: dssm.cntk:precision=float
MPI Rank 1: configparameters: dssm.cntk:reader=[
MPI Rank 1:     readerType = LibSVMBinaryReader
MPI Rank 1:     miniBatchMode = Partial
MPI Rank 1:     randomize = 0
MPI Rank 1:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 1: ]
MPI Rank 1: 
MPI Rank 1: configparameters: dssm.cntk:RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 1: configparameters: dssm.cntk:stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 1: configparameters: dssm.cntk:timestamping=true
MPI Rank 1: configparameters: dssm.cntk:traceGPUMemoryAllocations=0
MPI Rank 1: configparameters: dssm.cntk:train=[
MPI Rank 1:     action = train
MPI Rank 1:     numMBsToShowResult=10
MPI Rank 1:     deviceId=-1
MPI Rank 1:     minibatchSize = 4096
MPI Rank 1:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 1:     traceLevel = 1
MPI Rank 1:     SGD = [
MPI Rank 1:         epochSize=102399
MPI Rank 1:         learningRatesPerSample = 0.0001
MPI Rank 1:         momentumPerMB = 0.9
MPI Rank 1:         maxEpochs=3
MPI Rank 1:         ParallelTrain=[
MPI Rank 1:             parallelizationStartEpoch=1
MPI Rank 1:             parallelizationMethod=ModelAveragingSGD
MPI Rank 1:             distributedMBReading=true
MPI Rank 1:             ModelAveragingSGD=[
MPI Rank 1:                 SyncFrequencyInFrames=1024
MPI Rank 1:             ]
MPI Rank 1:         ]
MPI Rank 1: 		gradUpdateType=none
MPI Rank 1: 		gradientClippingWithTruncation=true
MPI Rank 1: 		clippingThresholdPerSample=1#INF
MPI Rank 1:     ]
MPI Rank 1: ]
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: <<<<<<<<<<<<<<<<<<<< PROCESSED CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 1: 04/05/2016 16:23:46: Commands: train
MPI Rank 1: 04/05/2016 16:23:46: Precision = "float"
MPI Rank 1: 04/05/2016 16:23:46: Using 5 CPU threads.
MPI Rank 1: 04/05/2016 16:23:46: CNTKModelPath: /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 1: 04/05/2016 16:23:46: CNTKCommandTrainInfo: train : 3
MPI Rank 1: 04/05/2016 16:23:46: CNTKCommandTrainInfo: CNTKNoMoreCommands_Total : 3
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: ##############################################################################
MPI Rank 1: 04/05/2016 16:23:46: #                                                                            #
MPI Rank 1: 04/05/2016 16:23:46: # Action "train"                                                             #
MPI Rank 1: 04/05/2016 16:23:46: #                                                                            #
MPI Rank 1: 04/05/2016 16:23:46: ##############################################################################
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: CNTKCommandTrainBegin: train
MPI Rank 1: NDLBuilder Using CPU
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: Creating virgin network.
MPI Rank 1: 
MPI Rank 1: Post-processing network...
MPI Rank 1: 
MPI Rank 1: 2 roots:
MPI Rank 1: 	CE = CrossEntropyWithSoftmax()
MPI Rank 1: 	SIM = CosDistanceWithNegativeSamples()
MPI Rank 1: 
MPI Rank 1: Validating network. 21 nodes to process in pass 1.
MPI Rank 1: 
MPI Rank 1: 
MPI Rank 1: Validating network. 11 nodes to process in pass 2.
MPI Rank 1: 
MPI Rank 1: 
MPI Rank 1: Validating network, final pass.
MPI Rank 1: 
MPI Rank 1: Validating --> DSSMLabel = InputValue() :  -> [51 x 1 x *]
MPI Rank 1: Validating --> G = LearnableParameter() :  -> [1 x 1]
MPI Rank 1: Validating --> WQ1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 1: Validating --> WQ0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 1: Validating --> Query = SparseInputValue() :  -> [49292 x *]
MPI Rank 1: Validating --> WQ0_Q = Times (WQ0, Query) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 1: Validating --> WQ0_Q_Tanh = Tanh (WQ0_Q) : [288 x *] -> [288 x *]
MPI Rank 1: Validating --> WQ1_Q = Times (WQ1, WQ0_Q_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 1: Validating --> WQ1_Q_Tanh = Tanh (WQ1_Q) : [64 x *] -> [64 x *]
MPI Rank 1: Validating --> WD1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 1: Validating --> WD0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 1: Validating --> Keyword = SparseInputValue() :  -> [49292 x *]
MPI Rank 1: Validating --> WD0_D = Times (WD0, Keyword) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 1: Validating --> WD0_D_Tanh = Tanh (WD0_D) : [288 x *] -> [288 x *]
MPI Rank 1: Validating --> WD1_D = Times (WD1, WD0_D_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 1: Validating --> WD1_D_Tanh = Tanh (WD1_D) : [64 x *] -> [64 x *]
MPI Rank 1: Validating --> S = LearnableParameter() :  -> [1 x 1]
MPI Rank 1: Validating --> N = LearnableParameter() :  -> [1 x 1]
MPI Rank 1: Validating --> SIM = CosDistanceWithNegativeSamples (WQ1_Q_Tanh, WD1_D_Tanh, S, N) : [64 x *], [64 x *], [1 x 1], [1 x 1] -> [51 x *]
MPI Rank 1: Validating --> SIM_Scale = ElementTimes (G, SIM) : [1 x 1], [51 x *] -> [51 x 1 x *]
MPI Rank 1: Validating --> CE = CrossEntropyWithSoftmax (DSSMLabel, SIM_Scale) : [51 x 1 x *], [51 x 1 x *] -> [1]
MPI Rank 1: 
MPI Rank 1: 
MPI Rank 1: 8 out of 21 nodes do not share the minibatch layout with the input data.
MPI Rank 1: 
MPI Rank 1: Post-processing network complete.
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: Created model with 21 nodes on CPU.
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:46: Training criterion node(s):
MPI Rank 1: 04/05/2016 16:23:46: 	CE = CrossEntropyWithSoftmax
MPI Rank 1: 
MPI Rank 1: 
MPI Rank 1: Allocating matrices for forward and/or backward propagation.
MPI Rank 1: 04/05/2016 16:23:46: No PreCompute nodes found, skipping PreCompute step.
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:49: Starting Epoch 1: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:23:49: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 1: 04/05/2016 16:23:56:  Epoch[ 1 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  3.47101059; TotalTime = 6.9638s; SamplesPerSecond = 1470.5
MPI Rank 1: 04/05/2016 16:24:02:  Epoch[ 1 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  2.69970703; TotalTime = 6.3378s; SamplesPerSecond = 1615.7
MPI Rank 1: 04/05/2016 16:24:05: Finished Epoch[ 1 of 3]: [Training Set] TrainLossPerSample = 2.9191892; TotalSamplesSeen = 102399; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=16.3588
MPI Rank 1: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 2.138047    Perplexity = 8.4828547    
MPI Rank 1: 04/05/2016 16:24:15: Finished Epoch[ 1 of 3]: [Validation Set] TrainLossPerSample = 2.138047
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:24:18: Starting Epoch 2: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:24:18: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 1: 04/05/2016 16:24:24:  Epoch[ 2 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  2.02775860; TotalTime = 6.1029s; SamplesPerSecond = 1677.9
MPI Rank 1: 04/05/2016 16:24:30:  Epoch[ 2 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.90990696; TotalTime = 5.8779s; SamplesPerSecond = 1742.1
MPI Rank 1: 04/05/2016 16:24:33: Finished Epoch[ 2 of 3]: [Training Set] TrainLossPerSample = 1.9437951; TotalSamplesSeen = 204798; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=14.9729
MPI Rank 1: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 1.8155899    Perplexity = 6.1447001    
MPI Rank 1: 04/05/2016 16:24:43: Finished Epoch[ 2 of 3]: [Validation Set] TrainLossPerSample = 1.8155899
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:24:46: Starting Epoch 3: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:24:46: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 1: 04/05/2016 16:24:52:  Epoch[ 3 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.77812557; TotalTime = 5.7654s; SamplesPerSecond = 1776.1
MPI Rank 1: 04/05/2016 16:24:57:  Epoch[ 3 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.74922543; TotalTime = 5.8526s; SamplesPerSecond = 1749.7
MPI Rank 1: 04/05/2016 16:25:01: Finished Epoch[ 3 of 3]: [Training Set] TrainLossPerSample = 1.7563989; TotalSamplesSeen = 307197; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=14.8007
MPI Rank 1: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 1.6991001    Perplexity = 5.4690234    
MPI Rank 1: 04/05/2016 16:25:11: Finished Epoch[ 3 of 3]: [Validation Set] TrainLossPerSample = 1.6991001
MPI Rank 1: 04/05/2016 16:25:13: CNTKCommandTrainEnd: train
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:13: Action "train" complete.
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:13: __COMPLETED__
MPI Rank 1: ~MPIWrapper
MPI Rank 2: 04/05/2016 16:23:46: -------------------------------------------------------------------
MPI Rank 2: 04/05/2016 16:23:46: Build info: 
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:46: 		Built time: Apr  5 2016 16:12:58
MPI Rank 2: 04/05/2016 16:23:46: 		Last modified date: Mon Apr  4 19:29:14 2016
MPI Rank 2: 04/05/2016 16:23:46: 		Build type: release
MPI Rank 2: 04/05/2016 16:23:46: 		Build target: GPU
MPI Rank 2: 04/05/2016 16:23:46: 		With 1bit-SGD: no
MPI Rank 2: 04/05/2016 16:23:46: 		Math lib: acml
MPI Rank 2: 04/05/2016 16:23:46: 		CUDA_PATH: /usr/local/cuda-7.0
MPI Rank 2: 04/05/2016 16:23:46: 		CUB_PATH: /usr/local/cub-1.4.1
MPI Rank 2: 04/05/2016 16:23:46: 		CUDNN_PATH: /usr/local/cudnn-4.0
MPI Rank 2: 04/05/2016 16:23:46: 		Build Branch: thhoens/matrixmerge
MPI Rank 2: 04/05/2016 16:23:46: 		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
MPI Rank 2: 04/05/2016 16:23:46: 		Built by REDMOND.thhoens on GCRGPUDEV029
MPI Rank 2: 04/05/2016 16:23:46: 		Build Path: /home/thhoens/cntk
MPI Rank 2: 04/05/2016 16:23:46: -------------------------------------------------------------------
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:46: Running on localhost at 2016/04/05 16:23:46
MPI Rank 2: 04/05/2016 16:23:46: Command line: 
MPI Rank 2: /home/thhoens/cntk/build/gpu/release/bin/cntk  configFile=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.cntk  currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/  OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DeviceId=-1  timestamping=true  numCPUThreads=5  stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 2: 
MPI Rank 2: 
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:46: >>>>>>>>>>>>>>>>>>>> RAW CONFIG (VARIABLES NOT RESOLVED) >>>>>>>>>>>>>>>>>>>>
MPI Rank 2: 04/05/2016 16:23:46: modelPath=$RunDir$/Models/dssm.net
MPI Rank 2: MBSize=4096
MPI Rank 2: LRate=0.0001
MPI Rank 2: DeviceId=-1
MPI Rank 2: parallelTrain=true
MPI Rank 2: command = train
MPI Rank 2: precision = float
MPI Rank 2: traceGPUMemoryAllocations=0
MPI Rank 2: train = [
MPI Rank 2:     action = train
MPI Rank 2:     numMBsToShowResult=10
MPI Rank 2:     deviceId=$DeviceId$
MPI Rank 2:     minibatchSize = $MBSize$
MPI Rank 2:     modelPath = $modelPath$
MPI Rank 2:     traceLevel = 1
MPI Rank 2:     SGD = [
MPI Rank 2:         epochSize=102399
MPI Rank 2:         learningRatesPerSample = $LRate$
MPI Rank 2:         momentumPerMB = 0.9
MPI Rank 2:         maxEpochs=3
MPI Rank 2:         ParallelTrain=[
MPI Rank 2:             parallelizationStartEpoch=1
MPI Rank 2:             parallelizationMethod=ModelAveragingSGD
MPI Rank 2:             distributedMBReading=true
MPI Rank 2:             ModelAveragingSGD=[
MPI Rank 2:                 SyncFrequencyInFrames=1024
MPI Rank 2:             ]
MPI Rank 2:         ]
MPI Rank 2: 		gradUpdateType=none
MPI Rank 2: 		gradientClippingWithTruncation=true
MPI Rank 2: 		clippingThresholdPerSample=1#INF
MPI Rank 2:     ]
MPI Rank 2: ]
MPI Rank 2: NDLNetworkBuilder = [
MPI Rank 2:     networkDescription = $ConfigDir$/dssm.ndl
MPI Rank 2: ]
MPI Rank 2: reader = [
MPI Rank 2:     readerType = LibSVMBinaryReader
MPI Rank 2:     miniBatchMode = Partial
MPI Rank 2:     randomize = 0
MPI Rank 2:     file = $DataDir$/train.all.bin
MPI Rank 2: ]
MPI Rank 2: cvReader = [
MPI Rank 2:     readerType = LibSVMBinaryReader
MPI Rank 2:     miniBatchMode = Partial
MPI Rank 2:     randomize = 0
MPI Rank 2:     file = $DataDir$/train.all.bin
MPI Rank 2: ]
MPI Rank 2: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 2: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 2: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 2: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 2: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 2: DeviceId=-1
MPI Rank 2: timestamping=true
MPI Rank 2: numCPUThreads=5
MPI Rank 2: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:46: <<<<<<<<<<<<<<<<<<<< RAW CONFIG (VARIABLES NOT RESOLVED)  <<<<<<<<<<<<<<<<<<<<
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:46: >>>>>>>>>>>>>>>>>>>> RAW CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 2: 04/05/2016 16:23:46: modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 2: MBSize=4096
MPI Rank 2: LRate=0.0001
MPI Rank 2: DeviceId=-1
MPI Rank 2: parallelTrain=true
MPI Rank 2: command = train
MPI Rank 2: precision = float
MPI Rank 2: traceGPUMemoryAllocations=0
MPI Rank 2: train = [
MPI Rank 2:     action = train
MPI Rank 2:     numMBsToShowResult=10
MPI Rank 2:     deviceId=-1
MPI Rank 2:     minibatchSize = 4096
MPI Rank 2:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 2:     traceLevel = 1
MPI Rank 2:     SGD = [
MPI Rank 2:         epochSize=102399
MPI Rank 2:         learningRatesPerSample = 0.0001
MPI Rank 2:         momentumPerMB = 0.9
MPI Rank 2:         maxEpochs=3
MPI Rank 2:         ParallelTrain=[
MPI Rank 2:             parallelizationStartEpoch=1
MPI Rank 2:             parallelizationMethod=ModelAveragingSGD
MPI Rank 2:             distributedMBReading=true
MPI Rank 2:             ModelAveragingSGD=[
MPI Rank 2:                 SyncFrequencyInFrames=1024
MPI Rank 2:             ]
MPI Rank 2:         ]
MPI Rank 2: 		gradUpdateType=none
MPI Rank 2: 		gradientClippingWithTruncation=true
MPI Rank 2: 		clippingThresholdPerSample=1#INF
MPI Rank 2:     ]
MPI Rank 2: ]
MPI Rank 2: NDLNetworkBuilder = [
MPI Rank 2:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 2: ]
MPI Rank 2: reader = [
MPI Rank 2:     readerType = LibSVMBinaryReader
MPI Rank 2:     miniBatchMode = Partial
MPI Rank 2:     randomize = 0
MPI Rank 2:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 2: ]
MPI Rank 2: cvReader = [
MPI Rank 2:     readerType = LibSVMBinaryReader
MPI Rank 2:     miniBatchMode = Partial
MPI Rank 2:     randomize = 0
MPI Rank 2:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 2: ]
MPI Rank 2: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 2: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 2: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 2: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 2: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 2: DeviceId=-1
MPI Rank 2: timestamping=true
MPI Rank 2: numCPUThreads=5
MPI Rank 2: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:46: <<<<<<<<<<<<<<<<<<<< RAW CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:46: >>>>>>>>>>>>>>>>>>>> PROCESSED CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 2: configparameters: dssm.cntk:command=train
MPI Rank 2: configparameters: dssm.cntk:ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 2: configparameters: dssm.cntk:currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 2: configparameters: dssm.cntk:cvReader=[
MPI Rank 2:     readerType = LibSVMBinaryReader
MPI Rank 2:     miniBatchMode = Partial
MPI Rank 2:     randomize = 0
MPI Rank 2:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 2: ]
MPI Rank 2: 
MPI Rank 2: configparameters: dssm.cntk:DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 2: configparameters: dssm.cntk:DeviceId=-1
MPI Rank 2: configparameters: dssm.cntk:LRate=0.0001
MPI Rank 2: configparameters: dssm.cntk:MBSize=4096
MPI Rank 2: configparameters: dssm.cntk:modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 2: configparameters: dssm.cntk:NDLNetworkBuilder=[
MPI Rank 2:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 2: ]
MPI Rank 2: 
MPI Rank 2: configparameters: dssm.cntk:numCPUThreads=5
MPI Rank 2: configparameters: dssm.cntk:OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 2: configparameters: dssm.cntk:parallelTrain=true
MPI Rank 2: configparameters: dssm.cntk:precision=float
MPI Rank 2: configparameters: dssm.cntk:reader=[
MPI Rank 2:     readerType = LibSVMBinaryReader
MPI Rank 2:     miniBatchMode = Partial
MPI Rank 2:     randomize = 0
MPI Rank 2:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 2: ]
MPI Rank 2: 
MPI Rank 2: configparameters: dssm.cntk:RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 2: configparameters: dssm.cntk:stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 2: configparameters: dssm.cntk:timestamping=true
MPI Rank 2: configparameters: dssm.cntk:traceGPUMemoryAllocations=0
MPI Rank 2: configparameters: dssm.cntk:train=[
MPI Rank 2:     action = train
MPI Rank 2:     numMBsToShowResult=10
MPI Rank 2:     deviceId=-1
MPI Rank 2:     minibatchSize = 4096
MPI Rank 2:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 2:     traceLevel = 1
MPI Rank 2:     SGD = [
MPI Rank 2:         epochSize=102399
MPI Rank 2:         learningRatesPerSample = 0.0001
MPI Rank 2:         momentumPerMB = 0.9
MPI Rank 2:         maxEpochs=3
MPI Rank 2:         ParallelTrain=[
MPI Rank 2:             parallelizationStartEpoch=1
MPI Rank 2:             parallelizationMethod=ModelAveragingSGD
MPI Rank 2:             distributedMBReading=true
MPI Rank 2:             ModelAveragingSGD=[
MPI Rank 2:                 SyncFrequencyInFrames=1024
MPI Rank 2:             ]
MPI Rank 2:         ]
MPI Rank 2: 		gradUpdateType=none
MPI Rank 2: 		gradientClippingWithTruncation=true
MPI Rank 2: 		clippingThresholdPerSample=1#INF
MPI Rank 2:     ]
MPI Rank 2: ]
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:46: <<<<<<<<<<<<<<<<<<<< PROCESSED CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 2: 04/05/2016 16:23:46: Commands: train
MPI Rank 2: 04/05/2016 16:23:46: Precision = "float"
MPI Rank 2: 04/05/2016 16:23:46: Using 5 CPU threads.
MPI Rank 2: 04/05/2016 16:23:46: CNTKModelPath: /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 2: 04/05/2016 16:23:46: CNTKCommandTrainInfo: train : 3
MPI Rank 2: 04/05/2016 16:23:46: CNTKCommandTrainInfo: CNTKNoMoreCommands_Total : 3
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:46: ##############################################################################
MPI Rank 2: 04/05/2016 16:23:46: #                                                                            #
MPI Rank 2: 04/05/2016 16:23:46: # Action "train"                                                             #
MPI Rank 2: 04/05/2016 16:23:46: #                                                                            #
MPI Rank 2: 04/05/2016 16:23:46: ##############################################################################
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:46: CNTKCommandTrainBegin: train
MPI Rank 2: NDLBuilder Using CPU
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:46: Creating virgin network.
MPI Rank 2: 
MPI Rank 2: Post-processing network...
MPI Rank 2: 
MPI Rank 2: 2 roots:
MPI Rank 2: 	CE = CrossEntropyWithSoftmax()
MPI Rank 2: 	SIM = CosDistanceWithNegativeSamples()
MPI Rank 2: 
MPI Rank 2: Validating network. 21 nodes to process in pass 1.
MPI Rank 2: 
MPI Rank 2: 
MPI Rank 2: Validating network. 11 nodes to process in pass 2.
MPI Rank 2: 
MPI Rank 2: 
MPI Rank 2: Validating network, final pass.
MPI Rank 2: 
MPI Rank 2: Validating --> DSSMLabel = InputValue() :  -> [51 x 1 x *]
MPI Rank 2: Validating --> G = LearnableParameter() :  -> [1 x 1]
MPI Rank 2: Validating --> WQ1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 2: Validating --> WQ0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 2: Validating --> Query = SparseInputValue() :  -> [49292 x *]
MPI Rank 2: Validating --> WQ0_Q = Times (WQ0, Query) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 2: Validating --> WQ0_Q_Tanh = Tanh (WQ0_Q) : [288 x *] -> [288 x *]
MPI Rank 2: Validating --> WQ1_Q = Times (WQ1, WQ0_Q_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 2: Validating --> WQ1_Q_Tanh = Tanh (WQ1_Q) : [64 x *] -> [64 x *]
MPI Rank 2: Validating --> WD1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 2: Validating --> WD0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 2: Validating --> Keyword = SparseInputValue() :  -> [49292 x *]
MPI Rank 2: Validating --> WD0_D = Times (WD0, Keyword) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 2: Validating --> WD0_D_Tanh = Tanh (WD0_D) : [288 x *] -> [288 x *]
MPI Rank 2: Validating --> WD1_D = Times (WD1, WD0_D_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 2: Validating --> WD1_D_Tanh = Tanh (WD1_D) : [64 x *] -> [64 x *]
MPI Rank 2: Validating --> S = LearnableParameter() :  -> [1 x 1]
MPI Rank 2: Validating --> N = LearnableParameter() :  -> [1 x 1]
MPI Rank 2: Validating --> SIM = CosDistanceWithNegativeSamples (WQ1_Q_Tanh, WD1_D_Tanh, S, N) : [64 x *], [64 x *], [1 x 1], [1 x 1] -> [51 x *]
MPI Rank 2: Validating --> SIM_Scale = ElementTimes (G, SIM) : [1 x 1], [51 x *] -> [51 x 1 x *]
MPI Rank 2: Validating --> CE = CrossEntropyWithSoftmax (DSSMLabel, SIM_Scale) : [51 x 1 x *], [51 x 1 x *] -> [1]
MPI Rank 2: 
MPI Rank 2: 
MPI Rank 2: 8 out of 21 nodes do not share the minibatch layout with the input data.
MPI Rank 2: 
MPI Rank 2: Post-processing network complete.
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:47: Created model with 21 nodes on CPU.
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:47: Training criterion node(s):
MPI Rank 2: 04/05/2016 16:23:47: 	CE = CrossEntropyWithSoftmax
MPI Rank 2: 
MPI Rank 2: 
MPI Rank 2: Allocating matrices for forward and/or backward propagation.
MPI Rank 2: 04/05/2016 16:23:47: No PreCompute nodes found, skipping PreCompute step.
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:49: Starting Epoch 1: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:23:49: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 2: 04/05/2016 16:23:56:  Epoch[ 1 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  3.44945602; TotalTime = 6.9710s; SamplesPerSecond = 1468.9
MPI Rank 2: 04/05/2016 16:24:02:  Epoch[ 1 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  2.72469749; TotalTime = 6.3378s; SamplesPerSecond = 1615.7
MPI Rank 2: 04/05/2016 16:24:05: Finished Epoch[ 1 of 3]: [Training Set] TrainLossPerSample = 2.9191892; TotalSamplesSeen = 102399; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=16.3588
MPI Rank 2: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 2.138047    Perplexity = 8.4828547    
MPI Rank 2: 04/05/2016 16:24:15: Finished Epoch[ 1 of 3]: [Validation Set] TrainLossPerSample = 2.138047
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:24:18: Starting Epoch 2: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:24:18: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 2: 04/05/2016 16:24:24:  Epoch[ 2 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  2.05766125; TotalTime = 6.1033s; SamplesPerSecond = 1677.8
MPI Rank 2: 04/05/2016 16:24:30:  Epoch[ 2 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.92501583; TotalTime = 5.8779s; SamplesPerSecond = 1742.1
MPI Rank 2: 04/05/2016 16:24:33: Finished Epoch[ 2 of 3]: [Training Set] TrainLossPerSample = 1.9437951; TotalSamplesSeen = 204798; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=14.9729
MPI Rank 2: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 1.8155899    Perplexity = 6.1447001    
MPI Rank 2: 04/05/2016 16:24:43: Finished Epoch[ 2 of 3]: [Validation Set] TrainLossPerSample = 1.8155899
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:24:46: Starting Epoch 3: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:24:46: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 2: 04/05/2016 16:24:52:  Epoch[ 3 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.82333508; TotalTime = 5.7661s; SamplesPerSecond = 1775.9
MPI Rank 2: 04/05/2016 16:24:57:  Epoch[ 3 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.76784000; TotalTime = 5.8526s; SamplesPerSecond = 1749.7
MPI Rank 2: 04/05/2016 16:25:01: Finished Epoch[ 3 of 3]: [Training Set] TrainLossPerSample = 1.7563989; TotalSamplesSeen = 307197; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=14.8007
MPI Rank 2: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 1.6991001    Perplexity = 5.4690234    
MPI Rank 2: 04/05/2016 16:25:11: Finished Epoch[ 3 of 3]: [Validation Set] TrainLossPerSample = 1.6991001
MPI Rank 2: 04/05/2016 16:25:13: CNTKCommandTrainEnd: train
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:13: Action "train" complete.
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:13: __COMPLETED__
MPI Rank 2: ~MPIWrapper
MPI Rank 3: 04/05/2016 16:23:47: -------------------------------------------------------------------
MPI Rank 3: 04/05/2016 16:23:47: Build info: 
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: 		Built time: Apr  5 2016 16:12:58
MPI Rank 3: 04/05/2016 16:23:47: 		Last modified date: Mon Apr  4 19:29:14 2016
MPI Rank 3: 04/05/2016 16:23:47: 		Build type: release
MPI Rank 3: 04/05/2016 16:23:47: 		Build target: GPU
MPI Rank 3: 04/05/2016 16:23:47: 		With 1bit-SGD: no
MPI Rank 3: 04/05/2016 16:23:47: 		Math lib: acml
MPI Rank 3: 04/05/2016 16:23:47: 		CUDA_PATH: /usr/local/cuda-7.0
MPI Rank 3: 04/05/2016 16:23:47: 		CUB_PATH: /usr/local/cub-1.4.1
MPI Rank 3: 04/05/2016 16:23:47: 		CUDNN_PATH: /usr/local/cudnn-4.0
MPI Rank 3: 04/05/2016 16:23:47: 		Build Branch: thhoens/matrixmerge
MPI Rank 3: 04/05/2016 16:23:47: 		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
MPI Rank 3: 04/05/2016 16:23:47: 		Built by REDMOND.thhoens on GCRGPUDEV029
MPI Rank 3: 04/05/2016 16:23:47: 		Build Path: /home/thhoens/cntk
MPI Rank 3: 04/05/2016 16:23:47: -------------------------------------------------------------------
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: Running on localhost at 2016/04/05 16:23:47
MPI Rank 3: 04/05/2016 16:23:47: Command line: 
MPI Rank 3: /home/thhoens/cntk/build/gpu/release/bin/cntk  configFile=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.cntk  currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/  OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DeviceId=-1  timestamping=true  numCPUThreads=5  stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 3: 
MPI Rank 3: 
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: >>>>>>>>>>>>>>>>>>>> RAW CONFIG (VARIABLES NOT RESOLVED) >>>>>>>>>>>>>>>>>>>>
MPI Rank 3: 04/05/2016 16:23:47: modelPath=$RunDir$/Models/dssm.net
MPI Rank 3: MBSize=4096
MPI Rank 3: LRate=0.0001
MPI Rank 3: DeviceId=-1
MPI Rank 3: parallelTrain=true
MPI Rank 3: command = train
MPI Rank 3: precision = float
MPI Rank 3: traceGPUMemoryAllocations=0
MPI Rank 3: train = [
MPI Rank 3:     action = train
MPI Rank 3:     numMBsToShowResult=10
MPI Rank 3:     deviceId=$DeviceId$
MPI Rank 3:     minibatchSize = $MBSize$
MPI Rank 3:     modelPath = $modelPath$
MPI Rank 3:     traceLevel = 1
MPI Rank 3:     SGD = [
MPI Rank 3:         epochSize=102399
MPI Rank 3:         learningRatesPerSample = $LRate$
MPI Rank 3:         momentumPerMB = 0.9
MPI Rank 3:         maxEpochs=3
MPI Rank 3:         ParallelTrain=[
MPI Rank 3:             parallelizationStartEpoch=1
MPI Rank 3:             parallelizationMethod=ModelAveragingSGD
MPI Rank 3:             distributedMBReading=true
MPI Rank 3:             ModelAveragingSGD=[
MPI Rank 3:                 SyncFrequencyInFrames=1024
MPI Rank 3:             ]
MPI Rank 3:         ]
MPI Rank 3: 		gradUpdateType=none
MPI Rank 3: 		gradientClippingWithTruncation=true
MPI Rank 3: 		clippingThresholdPerSample=1#INF
MPI Rank 3:     ]
MPI Rank 3: ]
MPI Rank 3: NDLNetworkBuilder = [
MPI Rank 3:     networkDescription = $ConfigDir$/dssm.ndl
MPI Rank 3: ]
MPI Rank 3: reader = [
MPI Rank 3:     readerType = LibSVMBinaryReader
MPI Rank 3:     miniBatchMode = Partial
MPI Rank 3:     randomize = 0
MPI Rank 3:     file = $DataDir$/train.all.bin
MPI Rank 3: ]
MPI Rank 3: cvReader = [
MPI Rank 3:     readerType = LibSVMBinaryReader
MPI Rank 3:     miniBatchMode = Partial
MPI Rank 3:     randomize = 0
MPI Rank 3:     file = $DataDir$/train.all.bin
MPI Rank 3: ]
MPI Rank 3: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 3: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 3: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 3: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 3: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 3: DeviceId=-1
MPI Rank 3: timestamping=true
MPI Rank 3: numCPUThreads=5
MPI Rank 3: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: <<<<<<<<<<<<<<<<<<<< RAW CONFIG (VARIABLES NOT RESOLVED)  <<<<<<<<<<<<<<<<<<<<
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: >>>>>>>>>>>>>>>>>>>> RAW CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 3: 04/05/2016 16:23:47: modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 3: MBSize=4096
MPI Rank 3: LRate=0.0001
MPI Rank 3: DeviceId=-1
MPI Rank 3: parallelTrain=true
MPI Rank 3: command = train
MPI Rank 3: precision = float
MPI Rank 3: traceGPUMemoryAllocations=0
MPI Rank 3: train = [
MPI Rank 3:     action = train
MPI Rank 3:     numMBsToShowResult=10
MPI Rank 3:     deviceId=-1
MPI Rank 3:     minibatchSize = 4096
MPI Rank 3:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 3:     traceLevel = 1
MPI Rank 3:     SGD = [
MPI Rank 3:         epochSize=102399
MPI Rank 3:         learningRatesPerSample = 0.0001
MPI Rank 3:         momentumPerMB = 0.9
MPI Rank 3:         maxEpochs=3
MPI Rank 3:         ParallelTrain=[
MPI Rank 3:             parallelizationStartEpoch=1
MPI Rank 3:             parallelizationMethod=ModelAveragingSGD
MPI Rank 3:             distributedMBReading=true
MPI Rank 3:             ModelAveragingSGD=[
MPI Rank 3:                 SyncFrequencyInFrames=1024
MPI Rank 3:             ]
MPI Rank 3:         ]
MPI Rank 3: 		gradUpdateType=none
MPI Rank 3: 		gradientClippingWithTruncation=true
MPI Rank 3: 		clippingThresholdPerSample=1#INF
MPI Rank 3:     ]
MPI Rank 3: ]
MPI Rank 3: NDLNetworkBuilder = [
MPI Rank 3:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 3: ]
MPI Rank 3: reader = [
MPI Rank 3:     readerType = LibSVMBinaryReader
MPI Rank 3:     miniBatchMode = Partial
MPI Rank 3:     randomize = 0
MPI Rank 3:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 3: ]
MPI Rank 3: cvReader = [
MPI Rank 3:     readerType = LibSVMBinaryReader
MPI Rank 3:     miniBatchMode = Partial
MPI Rank 3:     randomize = 0
MPI Rank 3:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 3: ]
MPI Rank 3: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 3: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 3: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 3: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 3: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 3: DeviceId=-1
MPI Rank 3: timestamping=true
MPI Rank 3: numCPUThreads=5
MPI Rank 3: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: <<<<<<<<<<<<<<<<<<<< RAW CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: >>>>>>>>>>>>>>>>>>>> PROCESSED CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 3: configparameters: dssm.cntk:command=train
MPI Rank 3: configparameters: dssm.cntk:ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 3: configparameters: dssm.cntk:currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 3: configparameters: dssm.cntk:cvReader=[
MPI Rank 3:     readerType = LibSVMBinaryReader
MPI Rank 3:     miniBatchMode = Partial
MPI Rank 3:     randomize = 0
MPI Rank 3:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 3: ]
MPI Rank 3: 
MPI Rank 3: configparameters: dssm.cntk:DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 3: configparameters: dssm.cntk:DeviceId=-1
MPI Rank 3: configparameters: dssm.cntk:LRate=0.0001
MPI Rank 3: configparameters: dssm.cntk:MBSize=4096
MPI Rank 3: configparameters: dssm.cntk:modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 3: configparameters: dssm.cntk:NDLNetworkBuilder=[
MPI Rank 3:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 3: ]
MPI Rank 3: 
MPI Rank 3: configparameters: dssm.cntk:numCPUThreads=5
MPI Rank 3: configparameters: dssm.cntk:OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 3: configparameters: dssm.cntk:parallelTrain=true
MPI Rank 3: configparameters: dssm.cntk:precision=float
MPI Rank 3: configparameters: dssm.cntk:reader=[
MPI Rank 3:     readerType = LibSVMBinaryReader
MPI Rank 3:     miniBatchMode = Partial
MPI Rank 3:     randomize = 0
MPI Rank 3:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 3: ]
MPI Rank 3: 
MPI Rank 3: configparameters: dssm.cntk:RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 3: configparameters: dssm.cntk:stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 3: configparameters: dssm.cntk:timestamping=true
MPI Rank 3: configparameters: dssm.cntk:traceGPUMemoryAllocations=0
MPI Rank 3: configparameters: dssm.cntk:train=[
MPI Rank 3:     action = train
MPI Rank 3:     numMBsToShowResult=10
MPI Rank 3:     deviceId=-1
MPI Rank 3:     minibatchSize = 4096
MPI Rank 3:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 3:     traceLevel = 1
MPI Rank 3:     SGD = [
MPI Rank 3:         epochSize=102399
MPI Rank 3:         learningRatesPerSample = 0.0001
MPI Rank 3:         momentumPerMB = 0.9
MPI Rank 3:         maxEpochs=3
MPI Rank 3:         ParallelTrain=[
MPI Rank 3:             parallelizationStartEpoch=1
MPI Rank 3:             parallelizationMethod=ModelAveragingSGD
MPI Rank 3:             distributedMBReading=true
MPI Rank 3:             ModelAveragingSGD=[
MPI Rank 3:                 SyncFrequencyInFrames=1024
MPI Rank 3:             ]
MPI Rank 3:         ]
MPI Rank 3: 		gradUpdateType=none
MPI Rank 3: 		gradientClippingWithTruncation=true
MPI Rank 3: 		clippingThresholdPerSample=1#INF
MPI Rank 3:     ]
MPI Rank 3: ]
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: <<<<<<<<<<<<<<<<<<<< PROCESSED CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 3: 04/05/2016 16:23:47: Commands: train
MPI Rank 3: 04/05/2016 16:23:47: Precision = "float"
MPI Rank 3: 04/05/2016 16:23:47: Using 5 CPU threads.
MPI Rank 3: 04/05/2016 16:23:47: CNTKModelPath: /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 3: 04/05/2016 16:23:47: CNTKCommandTrainInfo: train : 3
MPI Rank 3: 04/05/2016 16:23:47: CNTKCommandTrainInfo: CNTKNoMoreCommands_Total : 3
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: ##############################################################################
MPI Rank 3: 04/05/2016 16:23:47: #                                                                            #
MPI Rank 3: 04/05/2016 16:23:47: # Action "train"                                                             #
MPI Rank 3: 04/05/2016 16:23:47: #                                                                            #
MPI Rank 3: 04/05/2016 16:23:47: ##############################################################################
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: CNTKCommandTrainBegin: train
MPI Rank 3: NDLBuilder Using CPU
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: Creating virgin network.
MPI Rank 3: 
MPI Rank 3: Post-processing network...
MPI Rank 3: 
MPI Rank 3: 2 roots:
MPI Rank 3: 	CE = CrossEntropyWithSoftmax()
MPI Rank 3: 	SIM = CosDistanceWithNegativeSamples()
MPI Rank 3: 
MPI Rank 3: Validating network. 21 nodes to process in pass 1.
MPI Rank 3: 
MPI Rank 3: 
MPI Rank 3: Validating network. 11 nodes to process in pass 2.
MPI Rank 3: 
MPI Rank 3: 
MPI Rank 3: Validating network, final pass.
MPI Rank 3: 
MPI Rank 3: Validating --> DSSMLabel = InputValue() :  -> [51 x 1 x *]
MPI Rank 3: Validating --> G = LearnableParameter() :  -> [1 x 1]
MPI Rank 3: Validating --> WQ1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 3: Validating --> WQ0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 3: Validating --> Query = SparseInputValue() :  -> [49292 x *]
MPI Rank 3: Validating --> WQ0_Q = Times (WQ0, Query) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 3: Validating --> WQ0_Q_Tanh = Tanh (WQ0_Q) : [288 x *] -> [288 x *]
MPI Rank 3: Validating --> WQ1_Q = Times (WQ1, WQ0_Q_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 3: Validating --> WQ1_Q_Tanh = Tanh (WQ1_Q) : [64 x *] -> [64 x *]
MPI Rank 3: Validating --> WD1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 3: Validating --> WD0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 3: Validating --> Keyword = SparseInputValue() :  -> [49292 x *]
MPI Rank 3: Validating --> WD0_D = Times (WD0, Keyword) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 3: Validating --> WD0_D_Tanh = Tanh (WD0_D) : [288 x *] -> [288 x *]
MPI Rank 3: Validating --> WD1_D = Times (WD1, WD0_D_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 3: Validating --> WD1_D_Tanh = Tanh (WD1_D) : [64 x *] -> [64 x *]
MPI Rank 3: Validating --> S = LearnableParameter() :  -> [1 x 1]
MPI Rank 3: Validating --> N = LearnableParameter() :  -> [1 x 1]
MPI Rank 3: Validating --> SIM = CosDistanceWithNegativeSamples (WQ1_Q_Tanh, WD1_D_Tanh, S, N) : [64 x *], [64 x *], [1 x 1], [1 x 1] -> [51 x *]
MPI Rank 3: Validating --> SIM_Scale = ElementTimes (G, SIM) : [1 x 1], [51 x *] -> [51 x 1 x *]
MPI Rank 3: Validating --> CE = CrossEntropyWithSoftmax (DSSMLabel, SIM_Scale) : [51 x 1 x *], [51 x 1 x *] -> [1]
MPI Rank 3: 
MPI Rank 3: 
MPI Rank 3: 8 out of 21 nodes do not share the minibatch layout with the input data.
MPI Rank 3: 
MPI Rank 3: Post-processing network complete.
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: Created model with 21 nodes on CPU.
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:47: Training criterion node(s):
MPI Rank 3: 04/05/2016 16:23:47: 	CE = CrossEntropyWithSoftmax
MPI Rank 3: 
MPI Rank 3: 
MPI Rank 3: Allocating matrices for forward and/or backward propagation.
MPI Rank 3: 04/05/2016 16:23:47: No PreCompute nodes found, skipping PreCompute step.
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:49: Starting Epoch 1: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:23:49: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 3: 04/05/2016 16:23:56:  Epoch[ 1 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  3.44398956; TotalTime = 6.9840s; SamplesPerSecond = 1466.2
MPI Rank 3: 04/05/2016 16:24:02:  Epoch[ 1 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  2.71102791; TotalTime = 6.3378s; SamplesPerSecond = 1615.7
MPI Rank 3: 04/05/2016 16:24:05: Finished Epoch[ 1 of 3]: [Training Set] TrainLossPerSample = 2.9191892; TotalSamplesSeen = 102399; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=16.3588
MPI Rank 3: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 2.138047    Perplexity = 8.4828547    
MPI Rank 3: 04/05/2016 16:24:15: Finished Epoch[ 1 of 3]: [Validation Set] TrainLossPerSample = 2.138047
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:24:18: Starting Epoch 2: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:24:18: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 3: 04/05/2016 16:24:24:  Epoch[ 2 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  2.00262775; TotalTime = 6.1180s; SamplesPerSecond = 1673.8
MPI Rank 3: 04/05/2016 16:24:30:  Epoch[ 2 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.90484028; TotalTime = 5.8779s; SamplesPerSecond = 1742.1
MPI Rank 3: 04/05/2016 16:24:33: Finished Epoch[ 2 of 3]: [Training Set] TrainLossPerSample = 1.9437951; TotalSamplesSeen = 204798; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=14.9729
MPI Rank 3: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 1.8155899    Perplexity = 6.1447001    
MPI Rank 3: 04/05/2016 16:24:43: Finished Epoch[ 2 of 3]: [Validation Set] TrainLossPerSample = 1.8155899
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:24:46: Starting Epoch 3: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:24:46: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 3: 04/05/2016 16:24:52:  Epoch[ 3 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.75186119; TotalTime = 5.7808s; SamplesPerSecond = 1771.4
MPI Rank 3: 04/05/2016 16:24:57:  Epoch[ 3 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.73868065; TotalTime = 5.8526s; SamplesPerSecond = 1749.7
MPI Rank 3: 04/05/2016 16:25:01: Finished Epoch[ 3 of 3]: [Training Set] TrainLossPerSample = 1.7563989; TotalSamplesSeen = 307197; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=14.8007
MPI Rank 3: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 1.6991001    Perplexity = 5.4690234    
MPI Rank 3: 04/05/2016 16:25:11: Finished Epoch[ 3 of 3]: [Validation Set] TrainLossPerSample = 1.6991001
MPI Rank 3: 04/05/2016 16:25:13: CNTKCommandTrainEnd: train
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:13: Action "train" complete.
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:13: __COMPLETED__
MPI Rank 3: ~MPIWrapper
=== Deleting last epoch data
==== Re-running from checkpoint
=== Running mpiexec -n 4 /home/thhoens/cntk/build/gpu/release/bin/cntk configFile=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.cntk currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/ OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu DeviceId=-1 timestamping=true numCPUThreads=5 stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
-------------------------------------------------------------------
Build info: 

		Built time: Apr  5 2016 16:12:58
		Last modified date: Mon Apr  4 19:29:14 2016
		Build type: release
		Build target: GPU
		With 1bit-SGD: no
		Math lib: acml
		CUDA_PATH: /usr/local/cuda-7.0
		CUB_PATH: /usr/local/cub-1.4.1
		CUDNN_PATH: /usr/local/cudnn-4.0
		Build Branch: thhoens/matrixmerge
		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
		Built by REDMOND.thhoens on GCRGPUDEV029
		Build Path: /home/thhoens/cntk
-------------------------------------------------------------------
Changed current directory to /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPIWrapper: initializing MPI
-------------------------------------------------------------------
Build info: 

		Built time: Apr  5 2016 16:12:58
		Last modified date: Mon Apr  4 19:29:14 2016
		Build type: release
		Build target: GPU
		With 1bit-SGD: no
		Math lib: acml
		CUDA_PATH: /usr/local/cuda-7.0
		CUB_PATH: /usr/local/cub-1.4.1
		CUDNN_PATH: /usr/local/cudnn-4.0
		Build Branch: thhoens/matrixmerge
		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
		Built by REDMOND.thhoens on GCRGPUDEV029
		Build Path: /home/thhoens/cntk
-------------------------------------------------------------------
Changed current directory to /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPIWrapper: initializing MPI
-------------------------------------------------------------------
Build info: 

		Built time: Apr  5 2016 16:12:58
		Last modified date: Mon Apr  4 19:29:14 2016
		Build type: release
		Build target: GPU
		With 1bit-SGD: no
		Math lib: acml
		CUDA_PATH: /usr/local/cuda-7.0
		CUB_PATH: /usr/local/cub-1.4.1
		CUDNN_PATH: /usr/local/cudnn-4.0
		Build Branch: thhoens/matrixmerge
		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
		Built by REDMOND.thhoens on GCRGPUDEV029
		Build Path: /home/thhoens/cntk
-------------------------------------------------------------------
Changed current directory to /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPIWrapper: initializing MPI
-------------------------------------------------------------------
Build info: 

		Built time: Apr  5 2016 16:12:58
		Last modified date: Mon Apr  4 19:29:14 2016
		Build type: release
		Build target: GPU
		With 1bit-SGD: no
		Math lib: acml
		CUDA_PATH: /usr/local/cuda-7.0
		CUB_PATH: /usr/local/cub-1.4.1
		CUDNN_PATH: /usr/local/cudnn-4.0
		Build Branch: thhoens/matrixmerge
		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
		Built by REDMOND.thhoens on GCRGPUDEV029
		Build Path: /home/thhoens/cntk
-------------------------------------------------------------------
Changed current directory to /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPIWrapper: initializing MPI
ping [requestnodes (before change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: all 4 nodes responded
requestnodes [MPIWrapper]: using 4 out of 4 MPI nodes (4 requested); we (2) are in (participating)
ping [requestnodes (after change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: all 4 nodes responded
requestnodes [MPIWrapper]: using 4 out of 4 MPI nodes (4 requested); we (0) are in (participating)
ping [requestnodes (after change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: all 4 nodes responded
requestnodes [MPIWrapper]: using 4 out of 4 MPI nodes (4 requested); we (3) are in (participating)
ping [requestnodes (after change)]: 4 nodes pinging each other
ping [requestnodes (before change)]: all 4 nodes responded
requestnodes [MPIWrapper]: using 4 out of 4 MPI nodes (4 requested); we (1) are in (participating)
ping [requestnodes (after change)]: 4 nodes pinging each other
ping [requestnodes (after change)]: all 4 nodes responded
mpihelper: we are cog 2 in a gearbox of 4
ping [mpihelper]: 4 nodes pinging each other
ping [requestnodes (after change)]: all 4 nodes responded
mpihelper: we are cog 0 in a gearbox of 4
ping [mpihelper]: 4 nodes pinging each other
ping [requestnodes (after change)]: all 4 nodes responded
mpihelper: we are cog 3 in a gearbox of 4
ping [mpihelper]: 4 nodes pinging each other
ping [requestnodes (after change)]: all 4 nodes responded
mpihelper: we are cog 1 in a gearbox of 4
ping [mpihelper]: 4 nodes pinging each other
ping [mpihelper]: all 4 nodes responded
ping [mpihelper]: all 4 nodes responded
ping [mpihelper]: all 4 nodes responded
ping [mpihelper]: all 4 nodes responded
04/05/2016 16:25:15: Redirecting stderr to file /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr_train.logrank0
04/05/2016 16:25:15: Redirecting stderr to file /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr_train.logrank1
04/05/2016 16:25:16: Redirecting stderr to file /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr_train.logrank2
04/05/2016 16:25:16: Redirecting stderr to file /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr_train.logrank3
MPI Rank 0: 04/05/2016 16:25:15: -------------------------------------------------------------------
MPI Rank 0: 04/05/2016 16:25:15: Build info: 
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:15: 		Built time: Apr  5 2016 16:12:58
MPI Rank 0: 04/05/2016 16:25:15: 		Last modified date: Mon Apr  4 19:29:14 2016
MPI Rank 0: 04/05/2016 16:25:15: 		Build type: release
MPI Rank 0: 04/05/2016 16:25:15: 		Build target: GPU
MPI Rank 0: 04/05/2016 16:25:15: 		With 1bit-SGD: no
MPI Rank 0: 04/05/2016 16:25:15: 		Math lib: acml
MPI Rank 0: 04/05/2016 16:25:15: 		CUDA_PATH: /usr/local/cuda-7.0
MPI Rank 0: 04/05/2016 16:25:15: 		CUB_PATH: /usr/local/cub-1.4.1
MPI Rank 0: 04/05/2016 16:25:15: 		CUDNN_PATH: /usr/local/cudnn-4.0
MPI Rank 0: 04/05/2016 16:25:15: 		Build Branch: thhoens/matrixmerge
MPI Rank 0: 04/05/2016 16:25:15: 		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
MPI Rank 0: 04/05/2016 16:25:15: 		Built by REDMOND.thhoens on GCRGPUDEV029
MPI Rank 0: 04/05/2016 16:25:15: 		Build Path: /home/thhoens/cntk
MPI Rank 0: 04/05/2016 16:25:15: -------------------------------------------------------------------
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:15: Running on localhost at 2016/04/05 16:25:15
MPI Rank 0: 04/05/2016 16:25:15: Command line: 
MPI Rank 0: /home/thhoens/cntk/build/gpu/release/bin/cntk  configFile=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.cntk  currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/  OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DeviceId=-1  timestamping=true  numCPUThreads=5  stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 0: 
MPI Rank 0: 
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:15: >>>>>>>>>>>>>>>>>>>> RAW CONFIG (VARIABLES NOT RESOLVED) >>>>>>>>>>>>>>>>>>>>
MPI Rank 0: 04/05/2016 16:25:15: modelPath=$RunDir$/Models/dssm.net
MPI Rank 0: MBSize=4096
MPI Rank 0: LRate=0.0001
MPI Rank 0: DeviceId=-1
MPI Rank 0: parallelTrain=true
MPI Rank 0: command = train
MPI Rank 0: precision = float
MPI Rank 0: traceGPUMemoryAllocations=0
MPI Rank 0: train = [
MPI Rank 0:     action = train
MPI Rank 0:     numMBsToShowResult=10
MPI Rank 0:     deviceId=$DeviceId$
MPI Rank 0:     minibatchSize = $MBSize$
MPI Rank 0:     modelPath = $modelPath$
MPI Rank 0:     traceLevel = 1
MPI Rank 0:     SGD = [
MPI Rank 0:         epochSize=102399
MPI Rank 0:         learningRatesPerSample = $LRate$
MPI Rank 0:         momentumPerMB = 0.9
MPI Rank 0:         maxEpochs=3
MPI Rank 0:         ParallelTrain=[
MPI Rank 0:             parallelizationStartEpoch=1
MPI Rank 0:             parallelizationMethod=ModelAveragingSGD
MPI Rank 0:             distributedMBReading=true
MPI Rank 0:             ModelAveragingSGD=[
MPI Rank 0:                 SyncFrequencyInFrames=1024
MPI Rank 0:             ]
MPI Rank 0:         ]
MPI Rank 0: 		gradUpdateType=none
MPI Rank 0: 		gradientClippingWithTruncation=true
MPI Rank 0: 		clippingThresholdPerSample=1#INF
MPI Rank 0:     ]
MPI Rank 0: ]
MPI Rank 0: NDLNetworkBuilder = [
MPI Rank 0:     networkDescription = $ConfigDir$/dssm.ndl
MPI Rank 0: ]
MPI Rank 0: reader = [
MPI Rank 0:     readerType = LibSVMBinaryReader
MPI Rank 0:     miniBatchMode = Partial
MPI Rank 0:     randomize = 0
MPI Rank 0:     file = $DataDir$/train.all.bin
MPI Rank 0: ]
MPI Rank 0: cvReader = [
MPI Rank 0:     readerType = LibSVMBinaryReader
MPI Rank 0:     miniBatchMode = Partial
MPI Rank 0:     randomize = 0
MPI Rank 0:     file = $DataDir$/train.all.bin
MPI Rank 0: ]
MPI Rank 0: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 0: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 0: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 0: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 0: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 0: DeviceId=-1
MPI Rank 0: timestamping=true
MPI Rank 0: numCPUThreads=5
MPI Rank 0: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:15: <<<<<<<<<<<<<<<<<<<< RAW CONFIG (VARIABLES NOT RESOLVED)  <<<<<<<<<<<<<<<<<<<<
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:15: >>>>>>>>>>>>>>>>>>>> RAW CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 0: 04/05/2016 16:25:15: modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 0: MBSize=4096
MPI Rank 0: LRate=0.0001
MPI Rank 0: DeviceId=-1
MPI Rank 0: parallelTrain=true
MPI Rank 0: command = train
MPI Rank 0: precision = float
MPI Rank 0: traceGPUMemoryAllocations=0
MPI Rank 0: train = [
MPI Rank 0:     action = train
MPI Rank 0:     numMBsToShowResult=10
MPI Rank 0:     deviceId=-1
MPI Rank 0:     minibatchSize = 4096
MPI Rank 0:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 0:     traceLevel = 1
MPI Rank 0:     SGD = [
MPI Rank 0:         epochSize=102399
MPI Rank 0:         learningRatesPerSample = 0.0001
MPI Rank 0:         momentumPerMB = 0.9
MPI Rank 0:         maxEpochs=3
MPI Rank 0:         ParallelTrain=[
MPI Rank 0:             parallelizationStartEpoch=1
MPI Rank 0:             parallelizationMethod=ModelAveragingSGD
MPI Rank 0:             distributedMBReading=true
MPI Rank 0:             ModelAveragingSGD=[
MPI Rank 0:                 SyncFrequencyInFrames=1024
MPI Rank 0:             ]
MPI Rank 0:         ]
MPI Rank 0: 		gradUpdateType=none
MPI Rank 0: 		gradientClippingWithTruncation=true
MPI Rank 0: 		clippingThresholdPerSample=1#INF
MPI Rank 0:     ]
MPI Rank 0: ]
MPI Rank 0: NDLNetworkBuilder = [
MPI Rank 0:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 0: ]
MPI Rank 0: reader = [
MPI Rank 0:     readerType = LibSVMBinaryReader
MPI Rank 0:     miniBatchMode = Partial
MPI Rank 0:     randomize = 0
MPI Rank 0:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 0: ]
MPI Rank 0: cvReader = [
MPI Rank 0:     readerType = LibSVMBinaryReader
MPI Rank 0:     miniBatchMode = Partial
MPI Rank 0:     randomize = 0
MPI Rank 0:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 0: ]
MPI Rank 0: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 0: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 0: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 0: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 0: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 0: DeviceId=-1
MPI Rank 0: timestamping=true
MPI Rank 0: numCPUThreads=5
MPI Rank 0: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:15: <<<<<<<<<<<<<<<<<<<< RAW CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:15: >>>>>>>>>>>>>>>>>>>> PROCESSED CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 0: configparameters: dssm.cntk:command=train
MPI Rank 0: configparameters: dssm.cntk:ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 0: configparameters: dssm.cntk:currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 0: configparameters: dssm.cntk:cvReader=[
MPI Rank 0:     readerType = LibSVMBinaryReader
MPI Rank 0:     miniBatchMode = Partial
MPI Rank 0:     randomize = 0
MPI Rank 0:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 0: ]
MPI Rank 0: 
MPI Rank 0: configparameters: dssm.cntk:DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 0: configparameters: dssm.cntk:DeviceId=-1
MPI Rank 0: configparameters: dssm.cntk:LRate=0.0001
MPI Rank 0: configparameters: dssm.cntk:MBSize=4096
MPI Rank 0: configparameters: dssm.cntk:modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 0: configparameters: dssm.cntk:NDLNetworkBuilder=[
MPI Rank 0:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 0: ]
MPI Rank 0: 
MPI Rank 0: configparameters: dssm.cntk:numCPUThreads=5
MPI Rank 0: configparameters: dssm.cntk:OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 0: configparameters: dssm.cntk:parallelTrain=true
MPI Rank 0: configparameters: dssm.cntk:precision=float
MPI Rank 0: configparameters: dssm.cntk:reader=[
MPI Rank 0:     readerType = LibSVMBinaryReader
MPI Rank 0:     miniBatchMode = Partial
MPI Rank 0:     randomize = 0
MPI Rank 0:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 0: ]
MPI Rank 0: 
MPI Rank 0: configparameters: dssm.cntk:RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 0: configparameters: dssm.cntk:stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 0: configparameters: dssm.cntk:timestamping=true
MPI Rank 0: configparameters: dssm.cntk:traceGPUMemoryAllocations=0
MPI Rank 0: configparameters: dssm.cntk:train=[
MPI Rank 0:     action = train
MPI Rank 0:     numMBsToShowResult=10
MPI Rank 0:     deviceId=-1
MPI Rank 0:     minibatchSize = 4096
MPI Rank 0:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 0:     traceLevel = 1
MPI Rank 0:     SGD = [
MPI Rank 0:         epochSize=102399
MPI Rank 0:         learningRatesPerSample = 0.0001
MPI Rank 0:         momentumPerMB = 0.9
MPI Rank 0:         maxEpochs=3
MPI Rank 0:         ParallelTrain=[
MPI Rank 0:             parallelizationStartEpoch=1
MPI Rank 0:             parallelizationMethod=ModelAveragingSGD
MPI Rank 0:             distributedMBReading=true
MPI Rank 0:             ModelAveragingSGD=[
MPI Rank 0:                 SyncFrequencyInFrames=1024
MPI Rank 0:             ]
MPI Rank 0:         ]
MPI Rank 0: 		gradUpdateType=none
MPI Rank 0: 		gradientClippingWithTruncation=true
MPI Rank 0: 		clippingThresholdPerSample=1#INF
MPI Rank 0:     ]
MPI Rank 0: ]
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:15: <<<<<<<<<<<<<<<<<<<< PROCESSED CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 0: 04/05/2016 16:25:15: Commands: train
MPI Rank 0: 04/05/2016 16:25:15: Precision = "float"
MPI Rank 0: 04/05/2016 16:25:15: Using 5 CPU threads.
MPI Rank 0: 04/05/2016 16:25:15: CNTKModelPath: /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 0: 04/05/2016 16:25:15: CNTKCommandTrainInfo: train : 3
MPI Rank 0: 04/05/2016 16:25:15: CNTKCommandTrainInfo: CNTKNoMoreCommands_Total : 3
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:15: ##############################################################################
MPI Rank 0: 04/05/2016 16:25:15: #                                                                            #
MPI Rank 0: 04/05/2016 16:25:15: # Action "train"                                                             #
MPI Rank 0: 04/05/2016 16:25:15: #                                                                            #
MPI Rank 0: 04/05/2016 16:25:15: ##############################################################################
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:15: CNTKCommandTrainBegin: train
MPI Rank 0: NDLBuilder Using CPU
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:15: Starting from checkpoint. Loading network from '/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net.2'.
MPI Rank 0: 
MPI Rank 0: Post-processing network...
MPI Rank 0: 
MPI Rank 0: 2 roots:
MPI Rank 0: 	CE = CrossEntropyWithSoftmax()
MPI Rank 0: 	SIM = CosDistanceWithNegativeSamples()
MPI Rank 0: 
MPI Rank 0: Validating network. 21 nodes to process in pass 1.
MPI Rank 0: 
MPI Rank 0: 
MPI Rank 0: Validating network. 11 nodes to process in pass 2.
MPI Rank 0: 
MPI Rank 0: 
MPI Rank 0: Validating network, final pass.
MPI Rank 0: 
MPI Rank 0: Validating --> DSSMLabel = InputValue() :  -> [51 x 1 x *]
MPI Rank 0: Validating --> G = LearnableParameter() :  -> [1 x 1]
MPI Rank 0: Validating --> WQ1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 0: Validating --> WQ0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 0: Validating --> Query = SparseInputValue() :  -> [49292 x *]
MPI Rank 0: Validating --> WQ0_Q = Times (WQ0, Query) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 0: Validating --> WQ0_Q_Tanh = Tanh (WQ0_Q) : [288 x *] -> [288 x *]
MPI Rank 0: Validating --> WQ1_Q = Times (WQ1, WQ0_Q_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 0: Validating --> WQ1_Q_Tanh = Tanh (WQ1_Q) : [64 x *] -> [64 x *]
MPI Rank 0: Validating --> WD1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 0: Validating --> WD0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 0: Validating --> Keyword = SparseInputValue() :  -> [49292 x *]
MPI Rank 0: Validating --> WD0_D = Times (WD0, Keyword) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 0: Validating --> WD0_D_Tanh = Tanh (WD0_D) : [288 x *] -> [288 x *]
MPI Rank 0: Validating --> WD1_D = Times (WD1, WD0_D_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 0: Validating --> WD1_D_Tanh = Tanh (WD1_D) : [64 x *] -> [64 x *]
MPI Rank 0: Validating --> S = LearnableParameter() :  -> [1 x 1]
MPI Rank 0: Validating --> N = LearnableParameter() :  -> [1 x 1]
MPI Rank 0: Validating --> SIM = CosDistanceWithNegativeSamples (WQ1_Q_Tanh, WD1_D_Tanh, S, N) : [64 x *], [64 x *], [1 x 1], [1 x 1] -> [51 x *]
MPI Rank 0: Validating --> SIM_Scale = ElementTimes (G, SIM) : [1 x 1], [51 x *] -> [51 x 1 x *]
MPI Rank 0: Validating --> CE = CrossEntropyWithSoftmax (DSSMLabel, SIM_Scale) : [51 x 1 x *], [51 x 1 x *] -> [1]
MPI Rank 0: 
MPI Rank 0: 
MPI Rank 0: 8 out of 21 nodes do not share the minibatch layout with the input data.
MPI Rank 0: 
MPI Rank 0: Post-processing network complete.
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:16: Loaded model with 21 nodes on CPU.
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:16: Training criterion node(s):
MPI Rank 0: 04/05/2016 16:25:16: 	CE = CrossEntropyWithSoftmax
MPI Rank 0: 
MPI Rank 0: 
MPI Rank 0: Allocating matrices for forward and/or backward propagation.
MPI Rank 0: 04/05/2016 16:25:16: No PreCompute nodes found, skipping PreCompute step.
MPI Rank 0: 04/05/2016 16:25:16: Warning: checkpoint file is missing. learning parameters will be initialized from 0
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:17: Starting Epoch 3: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:18: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 0: 04/05/2016 16:25:25:  Epoch[ 3 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.77671967; TotalTime = 7.1413s; SamplesPerSecond = 1433.9
MPI Rank 0: 04/05/2016 16:25:31:  Epoch[ 3 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.79965210; TotalTime = 6.3966s; SamplesPerSecond = 1600.9
MPI Rank 0: 04/05/2016 16:25:34: Finished Epoch[ 3 of 3]: [Training Set] TrainLossPerSample = 1.8025136; TotalSamplesSeen = 102399; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=16.5363
MPI Rank 0: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 1.7629802    Perplexity = 5.8297857    
MPI Rank 0: 04/05/2016 16:25:44: Finished Epoch[ 3 of 3]: [Validation Set] TrainLossPerSample = 1.7629802
MPI Rank 0: 04/05/2016 16:25:46: SGD: Saving checkpoint model '/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net'
MPI Rank 0: 04/05/2016 16:25:47: CNTKCommandTrainEnd: train
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:47: Action "train" complete.
MPI Rank 0: 
MPI Rank 0: 04/05/2016 16:25:47: __COMPLETED__
MPI Rank 0: ~MPIWrapper
MPI Rank 1: 04/05/2016 16:25:15: -------------------------------------------------------------------
MPI Rank 1: 04/05/2016 16:25:15: Build info: 
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:15: 		Built time: Apr  5 2016 16:12:58
MPI Rank 1: 04/05/2016 16:25:15: 		Last modified date: Mon Apr  4 19:29:14 2016
MPI Rank 1: 04/05/2016 16:25:15: 		Build type: release
MPI Rank 1: 04/05/2016 16:25:15: 		Build target: GPU
MPI Rank 1: 04/05/2016 16:25:15: 		With 1bit-SGD: no
MPI Rank 1: 04/05/2016 16:25:15: 		Math lib: acml
MPI Rank 1: 04/05/2016 16:25:15: 		CUDA_PATH: /usr/local/cuda-7.0
MPI Rank 1: 04/05/2016 16:25:15: 		CUB_PATH: /usr/local/cub-1.4.1
MPI Rank 1: 04/05/2016 16:25:15: 		CUDNN_PATH: /usr/local/cudnn-4.0
MPI Rank 1: 04/05/2016 16:25:15: 		Build Branch: thhoens/matrixmerge
MPI Rank 1: 04/05/2016 16:25:15: 		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
MPI Rank 1: 04/05/2016 16:25:15: 		Built by REDMOND.thhoens on GCRGPUDEV029
MPI Rank 1: 04/05/2016 16:25:15: 		Build Path: /home/thhoens/cntk
MPI Rank 1: 04/05/2016 16:25:15: -------------------------------------------------------------------
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:15: Running on localhost at 2016/04/05 16:25:15
MPI Rank 1: 04/05/2016 16:25:15: Command line: 
MPI Rank 1: /home/thhoens/cntk/build/gpu/release/bin/cntk  configFile=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.cntk  currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/  OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DeviceId=-1  timestamping=true  numCPUThreads=5  stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 1: 
MPI Rank 1: 
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:15: >>>>>>>>>>>>>>>>>>>> RAW CONFIG (VARIABLES NOT RESOLVED) >>>>>>>>>>>>>>>>>>>>
MPI Rank 1: 04/05/2016 16:25:15: modelPath=$RunDir$/Models/dssm.net
MPI Rank 1: MBSize=4096
MPI Rank 1: LRate=0.0001
MPI Rank 1: DeviceId=-1
MPI Rank 1: parallelTrain=true
MPI Rank 1: command = train
MPI Rank 1: precision = float
MPI Rank 1: traceGPUMemoryAllocations=0
MPI Rank 1: train = [
MPI Rank 1:     action = train
MPI Rank 1:     numMBsToShowResult=10
MPI Rank 1:     deviceId=$DeviceId$
MPI Rank 1:     minibatchSize = $MBSize$
MPI Rank 1:     modelPath = $modelPath$
MPI Rank 1:     traceLevel = 1
MPI Rank 1:     SGD = [
MPI Rank 1:         epochSize=102399
MPI Rank 1:         learningRatesPerSample = $LRate$
MPI Rank 1:         momentumPerMB = 0.9
MPI Rank 1:         maxEpochs=3
MPI Rank 1:         ParallelTrain=[
MPI Rank 1:             parallelizationStartEpoch=1
MPI Rank 1:             parallelizationMethod=ModelAveragingSGD
MPI Rank 1:             distributedMBReading=true
MPI Rank 1:             ModelAveragingSGD=[
MPI Rank 1:                 SyncFrequencyInFrames=1024
MPI Rank 1:             ]
MPI Rank 1:         ]
MPI Rank 1: 		gradUpdateType=none
MPI Rank 1: 		gradientClippingWithTruncation=true
MPI Rank 1: 		clippingThresholdPerSample=1#INF
MPI Rank 1:     ]
MPI Rank 1: ]
MPI Rank 1: NDLNetworkBuilder = [
MPI Rank 1:     networkDescription = $ConfigDir$/dssm.ndl
MPI Rank 1: ]
MPI Rank 1: reader = [
MPI Rank 1:     readerType = LibSVMBinaryReader
MPI Rank 1:     miniBatchMode = Partial
MPI Rank 1:     randomize = 0
MPI Rank 1:     file = $DataDir$/train.all.bin
MPI Rank 1: ]
MPI Rank 1: cvReader = [
MPI Rank 1:     readerType = LibSVMBinaryReader
MPI Rank 1:     miniBatchMode = Partial
MPI Rank 1:     randomize = 0
MPI Rank 1:     file = $DataDir$/train.all.bin
MPI Rank 1: ]
MPI Rank 1: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 1: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 1: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 1: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 1: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 1: DeviceId=-1
MPI Rank 1: timestamping=true
MPI Rank 1: numCPUThreads=5
MPI Rank 1: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:15: <<<<<<<<<<<<<<<<<<<< RAW CONFIG (VARIABLES NOT RESOLVED)  <<<<<<<<<<<<<<<<<<<<
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:15: >>>>>>>>>>>>>>>>>>>> RAW CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 1: 04/05/2016 16:25:15: modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 1: MBSize=4096
MPI Rank 1: LRate=0.0001
MPI Rank 1: DeviceId=-1
MPI Rank 1: parallelTrain=true
MPI Rank 1: command = train
MPI Rank 1: precision = float
MPI Rank 1: traceGPUMemoryAllocations=0
MPI Rank 1: train = [
MPI Rank 1:     action = train
MPI Rank 1:     numMBsToShowResult=10
MPI Rank 1:     deviceId=-1
MPI Rank 1:     minibatchSize = 4096
MPI Rank 1:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 1:     traceLevel = 1
MPI Rank 1:     SGD = [
MPI Rank 1:         epochSize=102399
MPI Rank 1:         learningRatesPerSample = 0.0001
MPI Rank 1:         momentumPerMB = 0.9
MPI Rank 1:         maxEpochs=3
MPI Rank 1:         ParallelTrain=[
MPI Rank 1:             parallelizationStartEpoch=1
MPI Rank 1:             parallelizationMethod=ModelAveragingSGD
MPI Rank 1:             distributedMBReading=true
MPI Rank 1:             ModelAveragingSGD=[
MPI Rank 1:                 SyncFrequencyInFrames=1024
MPI Rank 1:             ]
MPI Rank 1:         ]
MPI Rank 1: 		gradUpdateType=none
MPI Rank 1: 		gradientClippingWithTruncation=true
MPI Rank 1: 		clippingThresholdPerSample=1#INF
MPI Rank 1:     ]
MPI Rank 1: ]
MPI Rank 1: NDLNetworkBuilder = [
MPI Rank 1:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 1: ]
MPI Rank 1: reader = [
MPI Rank 1:     readerType = LibSVMBinaryReader
MPI Rank 1:     miniBatchMode = Partial
MPI Rank 1:     randomize = 0
MPI Rank 1:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 1: ]
MPI Rank 1: cvReader = [
MPI Rank 1:     readerType = LibSVMBinaryReader
MPI Rank 1:     miniBatchMode = Partial
MPI Rank 1:     randomize = 0
MPI Rank 1:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 1: ]
MPI Rank 1: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 1: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 1: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 1: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 1: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 1: DeviceId=-1
MPI Rank 1: timestamping=true
MPI Rank 1: numCPUThreads=5
MPI Rank 1: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:15: <<<<<<<<<<<<<<<<<<<< RAW CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:15: >>>>>>>>>>>>>>>>>>>> PROCESSED CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 1: configparameters: dssm.cntk:command=train
MPI Rank 1: configparameters: dssm.cntk:ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 1: configparameters: dssm.cntk:currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 1: configparameters: dssm.cntk:cvReader=[
MPI Rank 1:     readerType = LibSVMBinaryReader
MPI Rank 1:     miniBatchMode = Partial
MPI Rank 1:     randomize = 0
MPI Rank 1:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 1: ]
MPI Rank 1: 
MPI Rank 1: configparameters: dssm.cntk:DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 1: configparameters: dssm.cntk:DeviceId=-1
MPI Rank 1: configparameters: dssm.cntk:LRate=0.0001
MPI Rank 1: configparameters: dssm.cntk:MBSize=4096
MPI Rank 1: configparameters: dssm.cntk:modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 1: configparameters: dssm.cntk:NDLNetworkBuilder=[
MPI Rank 1:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 1: ]
MPI Rank 1: 
MPI Rank 1: configparameters: dssm.cntk:numCPUThreads=5
MPI Rank 1: configparameters: dssm.cntk:OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 1: configparameters: dssm.cntk:parallelTrain=true
MPI Rank 1: configparameters: dssm.cntk:precision=float
MPI Rank 1: configparameters: dssm.cntk:reader=[
MPI Rank 1:     readerType = LibSVMBinaryReader
MPI Rank 1:     miniBatchMode = Partial
MPI Rank 1:     randomize = 0
MPI Rank 1:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 1: ]
MPI Rank 1: 
MPI Rank 1: configparameters: dssm.cntk:RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 1: configparameters: dssm.cntk:stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 1: configparameters: dssm.cntk:timestamping=true
MPI Rank 1: configparameters: dssm.cntk:traceGPUMemoryAllocations=0
MPI Rank 1: configparameters: dssm.cntk:train=[
MPI Rank 1:     action = train
MPI Rank 1:     numMBsToShowResult=10
MPI Rank 1:     deviceId=-1
MPI Rank 1:     minibatchSize = 4096
MPI Rank 1:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 1:     traceLevel = 1
MPI Rank 1:     SGD = [
MPI Rank 1:         epochSize=102399
MPI Rank 1:         learningRatesPerSample = 0.0001
MPI Rank 1:         momentumPerMB = 0.9
MPI Rank 1:         maxEpochs=3
MPI Rank 1:         ParallelTrain=[
MPI Rank 1:             parallelizationStartEpoch=1
MPI Rank 1:             parallelizationMethod=ModelAveragingSGD
MPI Rank 1:             distributedMBReading=true
MPI Rank 1:             ModelAveragingSGD=[
MPI Rank 1:                 SyncFrequencyInFrames=1024
MPI Rank 1:             ]
MPI Rank 1:         ]
MPI Rank 1: 		gradUpdateType=none
MPI Rank 1: 		gradientClippingWithTruncation=true
MPI Rank 1: 		clippingThresholdPerSample=1#INF
MPI Rank 1:     ]
MPI Rank 1: ]
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:15: <<<<<<<<<<<<<<<<<<<< PROCESSED CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 1: 04/05/2016 16:25:15: Commands: train
MPI Rank 1: 04/05/2016 16:25:15: Precision = "float"
MPI Rank 1: 04/05/2016 16:25:15: Using 5 CPU threads.
MPI Rank 1: 04/05/2016 16:25:15: CNTKModelPath: /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 1: 04/05/2016 16:25:15: CNTKCommandTrainInfo: train : 3
MPI Rank 1: 04/05/2016 16:25:15: CNTKCommandTrainInfo: CNTKNoMoreCommands_Total : 3
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:15: ##############################################################################
MPI Rank 1: 04/05/2016 16:25:15: #                                                                            #
MPI Rank 1: 04/05/2016 16:25:15: # Action "train"                                                             #
MPI Rank 1: 04/05/2016 16:25:15: #                                                                            #
MPI Rank 1: 04/05/2016 16:25:15: ##############################################################################
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:15: CNTKCommandTrainBegin: train
MPI Rank 1: NDLBuilder Using CPU
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:15: Starting from checkpoint. Loading network from '/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net.2'.
MPI Rank 1: 
MPI Rank 1: Post-processing network...
MPI Rank 1: 
MPI Rank 1: 2 roots:
MPI Rank 1: 	CE = CrossEntropyWithSoftmax()
MPI Rank 1: 	SIM = CosDistanceWithNegativeSamples()
MPI Rank 1: 
MPI Rank 1: Validating network. 21 nodes to process in pass 1.
MPI Rank 1: 
MPI Rank 1: 
MPI Rank 1: Validating network. 11 nodes to process in pass 2.
MPI Rank 1: 
MPI Rank 1: 
MPI Rank 1: Validating network, final pass.
MPI Rank 1: 
MPI Rank 1: Validating --> DSSMLabel = InputValue() :  -> [51 x 1 x *]
MPI Rank 1: Validating --> G = LearnableParameter() :  -> [1 x 1]
MPI Rank 1: Validating --> WQ1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 1: Validating --> WQ0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 1: Validating --> Query = SparseInputValue() :  -> [49292 x *]
MPI Rank 1: Validating --> WQ0_Q = Times (WQ0, Query) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 1: Validating --> WQ0_Q_Tanh = Tanh (WQ0_Q) : [288 x *] -> [288 x *]
MPI Rank 1: Validating --> WQ1_Q = Times (WQ1, WQ0_Q_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 1: Validating --> WQ1_Q_Tanh = Tanh (WQ1_Q) : [64 x *] -> [64 x *]
MPI Rank 1: Validating --> WD1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 1: Validating --> WD0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 1: Validating --> Keyword = SparseInputValue() :  -> [49292 x *]
MPI Rank 1: Validating --> WD0_D = Times (WD0, Keyword) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 1: Validating --> WD0_D_Tanh = Tanh (WD0_D) : [288 x *] -> [288 x *]
MPI Rank 1: Validating --> WD1_D = Times (WD1, WD0_D_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 1: Validating --> WD1_D_Tanh = Tanh (WD1_D) : [64 x *] -> [64 x *]
MPI Rank 1: Validating --> S = LearnableParameter() :  -> [1 x 1]
MPI Rank 1: Validating --> N = LearnableParameter() :  -> [1 x 1]
MPI Rank 1: Validating --> SIM = CosDistanceWithNegativeSamples (WQ1_Q_Tanh, WD1_D_Tanh, S, N) : [64 x *], [64 x *], [1 x 1], [1 x 1] -> [51 x *]
MPI Rank 1: Validating --> SIM_Scale = ElementTimes (G, SIM) : [1 x 1], [51 x *] -> [51 x 1 x *]
MPI Rank 1: Validating --> CE = CrossEntropyWithSoftmax (DSSMLabel, SIM_Scale) : [51 x 1 x *], [51 x 1 x *] -> [1]
MPI Rank 1: 
MPI Rank 1: 
MPI Rank 1: 8 out of 21 nodes do not share the minibatch layout with the input data.
MPI Rank 1: 
MPI Rank 1: Post-processing network complete.
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:17: Loaded model with 21 nodes on CPU.
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:17: Training criterion node(s):
MPI Rank 1: 04/05/2016 16:25:17: 	CE = CrossEntropyWithSoftmax
MPI Rank 1: 
MPI Rank 1: 
MPI Rank 1: Allocating matrices for forward and/or backward propagation.
MPI Rank 1: 04/05/2016 16:25:17: No PreCompute nodes found, skipping PreCompute step.
MPI Rank 1: 04/05/2016 16:25:17: Warning: checkpoint file is missing. learning parameters will be initialized from 0
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:17: Starting Epoch 3: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:18: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 1: 04/05/2016 16:25:25:  Epoch[ 3 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.79816246; TotalTime = 7.1354s; SamplesPerSecond = 1435.1
MPI Rank 1: 04/05/2016 16:25:31:  Epoch[ 3 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.80574760; TotalTime = 6.3966s; SamplesPerSecond = 1600.8
MPI Rank 1: 04/05/2016 16:25:34: Finished Epoch[ 3 of 3]: [Training Set] TrainLossPerSample = 1.8025136; TotalSamplesSeen = 102399; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=16.5363
MPI Rank 1: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 1.7629802    Perplexity = 5.8297857    
MPI Rank 1: 04/05/2016 16:25:44: Finished Epoch[ 3 of 3]: [Validation Set] TrainLossPerSample = 1.7629802
MPI Rank 1: 04/05/2016 16:25:47: CNTKCommandTrainEnd: train
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:47: Action "train" complete.
MPI Rank 1: 
MPI Rank 1: 04/05/2016 16:25:47: __COMPLETED__
MPI Rank 1: ~MPIWrapper
MPI Rank 2: 04/05/2016 16:25:16: -------------------------------------------------------------------
MPI Rank 2: 04/05/2016 16:25:16: Build info: 
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:16: 		Built time: Apr  5 2016 16:12:58
MPI Rank 2: 04/05/2016 16:25:16: 		Last modified date: Mon Apr  4 19:29:14 2016
MPI Rank 2: 04/05/2016 16:25:16: 		Build type: release
MPI Rank 2: 04/05/2016 16:25:16: 		Build target: GPU
MPI Rank 2: 04/05/2016 16:25:16: 		With 1bit-SGD: no
MPI Rank 2: 04/05/2016 16:25:16: 		Math lib: acml
MPI Rank 2: 04/05/2016 16:25:16: 		CUDA_PATH: /usr/local/cuda-7.0
MPI Rank 2: 04/05/2016 16:25:16: 		CUB_PATH: /usr/local/cub-1.4.1
MPI Rank 2: 04/05/2016 16:25:16: 		CUDNN_PATH: /usr/local/cudnn-4.0
MPI Rank 2: 04/05/2016 16:25:16: 		Build Branch: thhoens/matrixmerge
MPI Rank 2: 04/05/2016 16:25:16: 		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
MPI Rank 2: 04/05/2016 16:25:16: 		Built by REDMOND.thhoens on GCRGPUDEV029
MPI Rank 2: 04/05/2016 16:25:16: 		Build Path: /home/thhoens/cntk
MPI Rank 2: 04/05/2016 16:25:16: -------------------------------------------------------------------
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:16: Running on localhost at 2016/04/05 16:25:16
MPI Rank 2: 04/05/2016 16:25:16: Command line: 
MPI Rank 2: /home/thhoens/cntk/build/gpu/release/bin/cntk  configFile=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.cntk  currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/  OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DeviceId=-1  timestamping=true  numCPUThreads=5  stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 2: 
MPI Rank 2: 
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:16: >>>>>>>>>>>>>>>>>>>> RAW CONFIG (VARIABLES NOT RESOLVED) >>>>>>>>>>>>>>>>>>>>
MPI Rank 2: 04/05/2016 16:25:16: modelPath=$RunDir$/Models/dssm.net
MPI Rank 2: MBSize=4096
MPI Rank 2: LRate=0.0001
MPI Rank 2: DeviceId=-1
MPI Rank 2: parallelTrain=true
MPI Rank 2: command = train
MPI Rank 2: precision = float
MPI Rank 2: traceGPUMemoryAllocations=0
MPI Rank 2: train = [
MPI Rank 2:     action = train
MPI Rank 2:     numMBsToShowResult=10
MPI Rank 2:     deviceId=$DeviceId$
MPI Rank 2:     minibatchSize = $MBSize$
MPI Rank 2:     modelPath = $modelPath$
MPI Rank 2:     traceLevel = 1
MPI Rank 2:     SGD = [
MPI Rank 2:         epochSize=102399
MPI Rank 2:         learningRatesPerSample = $LRate$
MPI Rank 2:         momentumPerMB = 0.9
MPI Rank 2:         maxEpochs=3
MPI Rank 2:         ParallelTrain=[
MPI Rank 2:             parallelizationStartEpoch=1
MPI Rank 2:             parallelizationMethod=ModelAveragingSGD
MPI Rank 2:             distributedMBReading=true
MPI Rank 2:             ModelAveragingSGD=[
MPI Rank 2:                 SyncFrequencyInFrames=1024
MPI Rank 2:             ]
MPI Rank 2:         ]
MPI Rank 2: 		gradUpdateType=none
MPI Rank 2: 		gradientClippingWithTruncation=true
MPI Rank 2: 		clippingThresholdPerSample=1#INF
MPI Rank 2:     ]
MPI Rank 2: ]
MPI Rank 2: NDLNetworkBuilder = [
MPI Rank 2:     networkDescription = $ConfigDir$/dssm.ndl
MPI Rank 2: ]
MPI Rank 2: reader = [
MPI Rank 2:     readerType = LibSVMBinaryReader
MPI Rank 2:     miniBatchMode = Partial
MPI Rank 2:     randomize = 0
MPI Rank 2:     file = $DataDir$/train.all.bin
MPI Rank 2: ]
MPI Rank 2: cvReader = [
MPI Rank 2:     readerType = LibSVMBinaryReader
MPI Rank 2:     miniBatchMode = Partial
MPI Rank 2:     randomize = 0
MPI Rank 2:     file = $DataDir$/train.all.bin
MPI Rank 2: ]
MPI Rank 2: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 2: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 2: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 2: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 2: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 2: DeviceId=-1
MPI Rank 2: timestamping=true
MPI Rank 2: numCPUThreads=5
MPI Rank 2: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:16: <<<<<<<<<<<<<<<<<<<< RAW CONFIG (VARIABLES NOT RESOLVED)  <<<<<<<<<<<<<<<<<<<<
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:16: >>>>>>>>>>>>>>>>>>>> RAW CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 2: 04/05/2016 16:25:16: modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 2: MBSize=4096
MPI Rank 2: LRate=0.0001
MPI Rank 2: DeviceId=-1
MPI Rank 2: parallelTrain=true
MPI Rank 2: command = train
MPI Rank 2: precision = float
MPI Rank 2: traceGPUMemoryAllocations=0
MPI Rank 2: train = [
MPI Rank 2:     action = train
MPI Rank 2:     numMBsToShowResult=10
MPI Rank 2:     deviceId=-1
MPI Rank 2:     minibatchSize = 4096
MPI Rank 2:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 2:     traceLevel = 1
MPI Rank 2:     SGD = [
MPI Rank 2:         epochSize=102399
MPI Rank 2:         learningRatesPerSample = 0.0001
MPI Rank 2:         momentumPerMB = 0.9
MPI Rank 2:         maxEpochs=3
MPI Rank 2:         ParallelTrain=[
MPI Rank 2:             parallelizationStartEpoch=1
MPI Rank 2:             parallelizationMethod=ModelAveragingSGD
MPI Rank 2:             distributedMBReading=true
MPI Rank 2:             ModelAveragingSGD=[
MPI Rank 2:                 SyncFrequencyInFrames=1024
MPI Rank 2:             ]
MPI Rank 2:         ]
MPI Rank 2: 		gradUpdateType=none
MPI Rank 2: 		gradientClippingWithTruncation=true
MPI Rank 2: 		clippingThresholdPerSample=1#INF
MPI Rank 2:     ]
MPI Rank 2: ]
MPI Rank 2: NDLNetworkBuilder = [
MPI Rank 2:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 2: ]
MPI Rank 2: reader = [
MPI Rank 2:     readerType = LibSVMBinaryReader
MPI Rank 2:     miniBatchMode = Partial
MPI Rank 2:     randomize = 0
MPI Rank 2:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 2: ]
MPI Rank 2: cvReader = [
MPI Rank 2:     readerType = LibSVMBinaryReader
MPI Rank 2:     miniBatchMode = Partial
MPI Rank 2:     randomize = 0
MPI Rank 2:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 2: ]
MPI Rank 2: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 2: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 2: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 2: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 2: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 2: DeviceId=-1
MPI Rank 2: timestamping=true
MPI Rank 2: numCPUThreads=5
MPI Rank 2: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:16: <<<<<<<<<<<<<<<<<<<< RAW CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:16: >>>>>>>>>>>>>>>>>>>> PROCESSED CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 2: configparameters: dssm.cntk:command=train
MPI Rank 2: configparameters: dssm.cntk:ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 2: configparameters: dssm.cntk:currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 2: configparameters: dssm.cntk:cvReader=[
MPI Rank 2:     readerType = LibSVMBinaryReader
MPI Rank 2:     miniBatchMode = Partial
MPI Rank 2:     randomize = 0
MPI Rank 2:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 2: ]
MPI Rank 2: 
MPI Rank 2: configparameters: dssm.cntk:DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 2: configparameters: dssm.cntk:DeviceId=-1
MPI Rank 2: configparameters: dssm.cntk:LRate=0.0001
MPI Rank 2: configparameters: dssm.cntk:MBSize=4096
MPI Rank 2: configparameters: dssm.cntk:modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 2: configparameters: dssm.cntk:NDLNetworkBuilder=[
MPI Rank 2:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 2: ]
MPI Rank 2: 
MPI Rank 2: configparameters: dssm.cntk:numCPUThreads=5
MPI Rank 2: configparameters: dssm.cntk:OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 2: configparameters: dssm.cntk:parallelTrain=true
MPI Rank 2: configparameters: dssm.cntk:precision=float
MPI Rank 2: configparameters: dssm.cntk:reader=[
MPI Rank 2:     readerType = LibSVMBinaryReader
MPI Rank 2:     miniBatchMode = Partial
MPI Rank 2:     randomize = 0
MPI Rank 2:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 2: ]
MPI Rank 2: 
MPI Rank 2: configparameters: dssm.cntk:RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 2: configparameters: dssm.cntk:stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 2: configparameters: dssm.cntk:timestamping=true
MPI Rank 2: configparameters: dssm.cntk:traceGPUMemoryAllocations=0
MPI Rank 2: configparameters: dssm.cntk:train=[
MPI Rank 2:     action = train
MPI Rank 2:     numMBsToShowResult=10
MPI Rank 2:     deviceId=-1
MPI Rank 2:     minibatchSize = 4096
MPI Rank 2:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 2:     traceLevel = 1
MPI Rank 2:     SGD = [
MPI Rank 2:         epochSize=102399
MPI Rank 2:         learningRatesPerSample = 0.0001
MPI Rank 2:         momentumPerMB = 0.9
MPI Rank 2:         maxEpochs=3
MPI Rank 2:         ParallelTrain=[
MPI Rank 2:             parallelizationStartEpoch=1
MPI Rank 2:             parallelizationMethod=ModelAveragingSGD
MPI Rank 2:             distributedMBReading=true
MPI Rank 2:             ModelAveragingSGD=[
MPI Rank 2:                 SyncFrequencyInFrames=1024
MPI Rank 2:             ]
MPI Rank 2:         ]
MPI Rank 2: 		gradUpdateType=none
MPI Rank 2: 		gradientClippingWithTruncation=true
MPI Rank 2: 		clippingThresholdPerSample=1#INF
MPI Rank 2:     ]
MPI Rank 2: ]
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:16: <<<<<<<<<<<<<<<<<<<< PROCESSED CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 2: 04/05/2016 16:25:16: Commands: train
MPI Rank 2: 04/05/2016 16:25:16: Precision = "float"
MPI Rank 2: 04/05/2016 16:25:16: Using 5 CPU threads.
MPI Rank 2: 04/05/2016 16:25:16: CNTKModelPath: /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 2: 04/05/2016 16:25:16: CNTKCommandTrainInfo: train : 3
MPI Rank 2: 04/05/2016 16:25:16: CNTKCommandTrainInfo: CNTKNoMoreCommands_Total : 3
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:16: ##############################################################################
MPI Rank 2: 04/05/2016 16:25:16: #                                                                            #
MPI Rank 2: 04/05/2016 16:25:16: # Action "train"                                                             #
MPI Rank 2: 04/05/2016 16:25:16: #                                                                            #
MPI Rank 2: 04/05/2016 16:25:16: ##############################################################################
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:16: CNTKCommandTrainBegin: train
MPI Rank 2: NDLBuilder Using CPU
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:16: Starting from checkpoint. Loading network from '/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net.2'.
MPI Rank 2: 
MPI Rank 2: Post-processing network...
MPI Rank 2: 
MPI Rank 2: 2 roots:
MPI Rank 2: 	CE = CrossEntropyWithSoftmax()
MPI Rank 2: 	SIM = CosDistanceWithNegativeSamples()
MPI Rank 2: 
MPI Rank 2: Validating network. 21 nodes to process in pass 1.
MPI Rank 2: 
MPI Rank 2: 
MPI Rank 2: Validating network. 11 nodes to process in pass 2.
MPI Rank 2: 
MPI Rank 2: 
MPI Rank 2: Validating network, final pass.
MPI Rank 2: 
MPI Rank 2: Validating --> DSSMLabel = InputValue() :  -> [51 x 1 x *]
MPI Rank 2: Validating --> G = LearnableParameter() :  -> [1 x 1]
MPI Rank 2: Validating --> WQ1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 2: Validating --> WQ0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 2: Validating --> Query = SparseInputValue() :  -> [49292 x *]
MPI Rank 2: Validating --> WQ0_Q = Times (WQ0, Query) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 2: Validating --> WQ0_Q_Tanh = Tanh (WQ0_Q) : [288 x *] -> [288 x *]
MPI Rank 2: Validating --> WQ1_Q = Times (WQ1, WQ0_Q_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 2: Validating --> WQ1_Q_Tanh = Tanh (WQ1_Q) : [64 x *] -> [64 x *]
MPI Rank 2: Validating --> WD1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 2: Validating --> WD0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 2: Validating --> Keyword = SparseInputValue() :  -> [49292 x *]
MPI Rank 2: Validating --> WD0_D = Times (WD0, Keyword) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 2: Validating --> WD0_D_Tanh = Tanh (WD0_D) : [288 x *] -> [288 x *]
MPI Rank 2: Validating --> WD1_D = Times (WD1, WD0_D_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 2: Validating --> WD1_D_Tanh = Tanh (WD1_D) : [64 x *] -> [64 x *]
MPI Rank 2: Validating --> S = LearnableParameter() :  -> [1 x 1]
MPI Rank 2: Validating --> N = LearnableParameter() :  -> [1 x 1]
MPI Rank 2: Validating --> SIM = CosDistanceWithNegativeSamples (WQ1_Q_Tanh, WD1_D_Tanh, S, N) : [64 x *], [64 x *], [1 x 1], [1 x 1] -> [51 x *]
MPI Rank 2: Validating --> SIM_Scale = ElementTimes (G, SIM) : [1 x 1], [51 x *] -> [51 x 1 x *]
MPI Rank 2: Validating --> CE = CrossEntropyWithSoftmax (DSSMLabel, SIM_Scale) : [51 x 1 x *], [51 x 1 x *] -> [1]
MPI Rank 2: 
MPI Rank 2: 
MPI Rank 2: 8 out of 21 nodes do not share the minibatch layout with the input data.
MPI Rank 2: 
MPI Rank 2: Post-processing network complete.
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:17: Loaded model with 21 nodes on CPU.
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:17: Training criterion node(s):
MPI Rank 2: 04/05/2016 16:25:17: 	CE = CrossEntropyWithSoftmax
MPI Rank 2: 
MPI Rank 2: 
MPI Rank 2: Allocating matrices for forward and/or backward propagation.
MPI Rank 2: 04/05/2016 16:25:17: No PreCompute nodes found, skipping PreCompute step.
MPI Rank 2: 04/05/2016 16:25:17: Warning: checkpoint file is missing. learning parameters will be initialized from 0
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:17: Starting Epoch 3: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:18: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 2: 04/05/2016 16:25:25:  Epoch[ 3 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.84275951; TotalTime = 7.1414s; SamplesPerSecond = 1433.9
MPI Rank 2: 04/05/2016 16:25:31:  Epoch[ 3 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.82326298; TotalTime = 6.3966s; SamplesPerSecond = 1600.9
MPI Rank 2: 04/05/2016 16:25:34: Finished Epoch[ 3 of 3]: [Training Set] TrainLossPerSample = 1.8025136; TotalSamplesSeen = 102399; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=16.5364
MPI Rank 2: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 1.7629802    Perplexity = 5.8297857    
MPI Rank 2: 04/05/2016 16:25:44: Finished Epoch[ 3 of 3]: [Validation Set] TrainLossPerSample = 1.7629802
MPI Rank 2: 04/05/2016 16:25:47: CNTKCommandTrainEnd: train
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:47: Action "train" complete.
MPI Rank 2: 
MPI Rank 2: 04/05/2016 16:25:47: __COMPLETED__
MPI Rank 2: ~MPIWrapper
MPI Rank 3: 04/05/2016 16:25:16: -------------------------------------------------------------------
MPI Rank 3: 04/05/2016 16:25:16: Build info: 
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:16: 		Built time: Apr  5 2016 16:12:58
MPI Rank 3: 04/05/2016 16:25:16: 		Last modified date: Mon Apr  4 19:29:14 2016
MPI Rank 3: 04/05/2016 16:25:16: 		Build type: release
MPI Rank 3: 04/05/2016 16:25:16: 		Build target: GPU
MPI Rank 3: 04/05/2016 16:25:16: 		With 1bit-SGD: no
MPI Rank 3: 04/05/2016 16:25:16: 		Math lib: acml
MPI Rank 3: 04/05/2016 16:25:16: 		CUDA_PATH: /usr/local/cuda-7.0
MPI Rank 3: 04/05/2016 16:25:16: 		CUB_PATH: /usr/local/cub-1.4.1
MPI Rank 3: 04/05/2016 16:25:16: 		CUDNN_PATH: /usr/local/cudnn-4.0
MPI Rank 3: 04/05/2016 16:25:16: 		Build Branch: thhoens/matrixmerge
MPI Rank 3: 04/05/2016 16:25:16: 		Build SHA1: 16dc4f2ba8c2572f523be3bdac642d21e74712fa (modified)
MPI Rank 3: 04/05/2016 16:25:16: 		Built by REDMOND.thhoens on GCRGPUDEV029
MPI Rank 3: 04/05/2016 16:25:16: 		Build Path: /home/thhoens/cntk
MPI Rank 3: 04/05/2016 16:25:16: -------------------------------------------------------------------
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:16: Running on localhost at 2016/04/05 16:25:16
MPI Rank 3: 04/05/2016 16:25:16: Command line: 
MPI Rank 3: /home/thhoens/cntk/build/gpu/release/bin/cntk  configFile=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.cntk  currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData  ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/  OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu  DeviceId=-1  timestamping=true  numCPUThreads=5  stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 3: 
MPI Rank 3: 
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:16: >>>>>>>>>>>>>>>>>>>> RAW CONFIG (VARIABLES NOT RESOLVED) >>>>>>>>>>>>>>>>>>>>
MPI Rank 3: 04/05/2016 16:25:16: modelPath=$RunDir$/Models/dssm.net
MPI Rank 3: MBSize=4096
MPI Rank 3: LRate=0.0001
MPI Rank 3: DeviceId=-1
MPI Rank 3: parallelTrain=true
MPI Rank 3: command = train
MPI Rank 3: precision = float
MPI Rank 3: traceGPUMemoryAllocations=0
MPI Rank 3: train = [
MPI Rank 3:     action = train
MPI Rank 3:     numMBsToShowResult=10
MPI Rank 3:     deviceId=$DeviceId$
MPI Rank 3:     minibatchSize = $MBSize$
MPI Rank 3:     modelPath = $modelPath$
MPI Rank 3:     traceLevel = 1
MPI Rank 3:     SGD = [
MPI Rank 3:         epochSize=102399
MPI Rank 3:         learningRatesPerSample = $LRate$
MPI Rank 3:         momentumPerMB = 0.9
MPI Rank 3:         maxEpochs=3
MPI Rank 3:         ParallelTrain=[
MPI Rank 3:             parallelizationStartEpoch=1
MPI Rank 3:             parallelizationMethod=ModelAveragingSGD
MPI Rank 3:             distributedMBReading=true
MPI Rank 3:             ModelAveragingSGD=[
MPI Rank 3:                 SyncFrequencyInFrames=1024
MPI Rank 3:             ]
MPI Rank 3:         ]
MPI Rank 3: 		gradUpdateType=none
MPI Rank 3: 		gradientClippingWithTruncation=true
MPI Rank 3: 		clippingThresholdPerSample=1#INF
MPI Rank 3:     ]
MPI Rank 3: ]
MPI Rank 3: NDLNetworkBuilder = [
MPI Rank 3:     networkDescription = $ConfigDir$/dssm.ndl
MPI Rank 3: ]
MPI Rank 3: reader = [
MPI Rank 3:     readerType = LibSVMBinaryReader
MPI Rank 3:     miniBatchMode = Partial
MPI Rank 3:     randomize = 0
MPI Rank 3:     file = $DataDir$/train.all.bin
MPI Rank 3: ]
MPI Rank 3: cvReader = [
MPI Rank 3:     readerType = LibSVMBinaryReader
MPI Rank 3:     miniBatchMode = Partial
MPI Rank 3:     randomize = 0
MPI Rank 3:     file = $DataDir$/train.all.bin
MPI Rank 3: ]
MPI Rank 3: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 3: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 3: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 3: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 3: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 3: DeviceId=-1
MPI Rank 3: timestamping=true
MPI Rank 3: numCPUThreads=5
MPI Rank 3: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:16: <<<<<<<<<<<<<<<<<<<< RAW CONFIG (VARIABLES NOT RESOLVED)  <<<<<<<<<<<<<<<<<<<<
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:16: >>>>>>>>>>>>>>>>>>>> RAW CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 3: 04/05/2016 16:25:16: modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 3: MBSize=4096
MPI Rank 3: LRate=0.0001
MPI Rank 3: DeviceId=-1
MPI Rank 3: parallelTrain=true
MPI Rank 3: command = train
MPI Rank 3: precision = float
MPI Rank 3: traceGPUMemoryAllocations=0
MPI Rank 3: train = [
MPI Rank 3:     action = train
MPI Rank 3:     numMBsToShowResult=10
MPI Rank 3:     deviceId=-1
MPI Rank 3:     minibatchSize = 4096
MPI Rank 3:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 3:     traceLevel = 1
MPI Rank 3:     SGD = [
MPI Rank 3:         epochSize=102399
MPI Rank 3:         learningRatesPerSample = 0.0001
MPI Rank 3:         momentumPerMB = 0.9
MPI Rank 3:         maxEpochs=3
MPI Rank 3:         ParallelTrain=[
MPI Rank 3:             parallelizationStartEpoch=1
MPI Rank 3:             parallelizationMethod=ModelAveragingSGD
MPI Rank 3:             distributedMBReading=true
MPI Rank 3:             ModelAveragingSGD=[
MPI Rank 3:                 SyncFrequencyInFrames=1024
MPI Rank 3:             ]
MPI Rank 3:         ]
MPI Rank 3: 		gradUpdateType=none
MPI Rank 3: 		gradientClippingWithTruncation=true
MPI Rank 3: 		clippingThresholdPerSample=1#INF
MPI Rank 3:     ]
MPI Rank 3: ]
MPI Rank 3: NDLNetworkBuilder = [
MPI Rank 3:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 3: ]
MPI Rank 3: reader = [
MPI Rank 3:     readerType = LibSVMBinaryReader
MPI Rank 3:     miniBatchMode = Partial
MPI Rank 3:     randomize = 0
MPI Rank 3:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 3: ]
MPI Rank 3: cvReader = [
MPI Rank 3:     readerType = LibSVMBinaryReader
MPI Rank 3:     miniBatchMode = Partial
MPI Rank 3:     randomize = 0
MPI Rank 3:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 3: ]
MPI Rank 3: currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 3: RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 3: DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 3: ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 3: OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 3: DeviceId=-1
MPI Rank 3: timestamping=true
MPI Rank 3: numCPUThreads=5
MPI Rank 3: stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:16: <<<<<<<<<<<<<<<<<<<< RAW CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:16: >>>>>>>>>>>>>>>>>>>> PROCESSED CONFIG WITH ALL VARIABLES RESOLVED >>>>>>>>>>>>>>>>>>>>
MPI Rank 3: configparameters: dssm.cntk:command=train
MPI Rank 3: configparameters: dssm.cntk:ConfigDir=/home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM/
MPI Rank 3: configparameters: dssm.cntk:currentDirectory=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 3: configparameters: dssm.cntk:cvReader=[
MPI Rank 3:     readerType = LibSVMBinaryReader
MPI Rank 3:     miniBatchMode = Partial
MPI Rank 3:     randomize = 0
MPI Rank 3:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 3: ]
MPI Rank 3: 
MPI Rank 3: configparameters: dssm.cntk:DataDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData
MPI Rank 3: configparameters: dssm.cntk:DeviceId=-1
MPI Rank 3: configparameters: dssm.cntk:LRate=0.0001
MPI Rank 3: configparameters: dssm.cntk:MBSize=4096
MPI Rank 3: configparameters: dssm.cntk:modelPath=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 3: configparameters: dssm.cntk:NDLNetworkBuilder=[
MPI Rank 3:     networkDescription = /home/thhoens/cntk/Tests/EndToEndTests/Text/SparseDSSM//dssm.ndl
MPI Rank 3: ]
MPI Rank 3: 
MPI Rank 3: configparameters: dssm.cntk:numCPUThreads=5
MPI Rank 3: configparameters: dssm.cntk:OutputDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 3: configparameters: dssm.cntk:parallelTrain=true
MPI Rank 3: configparameters: dssm.cntk:precision=float
MPI Rank 3: configparameters: dssm.cntk:reader=[
MPI Rank 3:     readerType = LibSVMBinaryReader
MPI Rank 3:     miniBatchMode = Partial
MPI Rank 3:     randomize = 0
MPI Rank 3:     file = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/TestData/train.all.bin
MPI Rank 3: ]
MPI Rank 3: 
MPI Rank 3: configparameters: dssm.cntk:RunDir=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu
MPI Rank 3: configparameters: dssm.cntk:stderr=/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/stderr
MPI Rank 3: configparameters: dssm.cntk:timestamping=true
MPI Rank 3: configparameters: dssm.cntk:traceGPUMemoryAllocations=0
MPI Rank 3: configparameters: dssm.cntk:train=[
MPI Rank 3:     action = train
MPI Rank 3:     numMBsToShowResult=10
MPI Rank 3:     deviceId=-1
MPI Rank 3:     minibatchSize = 4096
MPI Rank 3:     modelPath = /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 3:     traceLevel = 1
MPI Rank 3:     SGD = [
MPI Rank 3:         epochSize=102399
MPI Rank 3:         learningRatesPerSample = 0.0001
MPI Rank 3:         momentumPerMB = 0.9
MPI Rank 3:         maxEpochs=3
MPI Rank 3:         ParallelTrain=[
MPI Rank 3:             parallelizationStartEpoch=1
MPI Rank 3:             parallelizationMethod=ModelAveragingSGD
MPI Rank 3:             distributedMBReading=true
MPI Rank 3:             ModelAveragingSGD=[
MPI Rank 3:                 SyncFrequencyInFrames=1024
MPI Rank 3:             ]
MPI Rank 3:         ]
MPI Rank 3: 		gradUpdateType=none
MPI Rank 3: 		gradientClippingWithTruncation=true
MPI Rank 3: 		clippingThresholdPerSample=1#INF
MPI Rank 3:     ]
MPI Rank 3: ]
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:16: <<<<<<<<<<<<<<<<<<<< PROCESSED CONFIG WITH ALL VARIABLES RESOLVED <<<<<<<<<<<<<<<<<<<<
MPI Rank 3: 04/05/2016 16:25:16: Commands: train
MPI Rank 3: 04/05/2016 16:25:16: Precision = "float"
MPI Rank 3: 04/05/2016 16:25:16: Using 5 CPU threads.
MPI Rank 3: 04/05/2016 16:25:16: CNTKModelPath: /tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net
MPI Rank 3: 04/05/2016 16:25:16: CNTKCommandTrainInfo: train : 3
MPI Rank 3: 04/05/2016 16:25:16: CNTKCommandTrainInfo: CNTKNoMoreCommands_Total : 3
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:16: ##############################################################################
MPI Rank 3: 04/05/2016 16:25:16: #                                                                            #
MPI Rank 3: 04/05/2016 16:25:16: # Action "train"                                                             #
MPI Rank 3: 04/05/2016 16:25:16: #                                                                            #
MPI Rank 3: 04/05/2016 16:25:16: ##############################################################################
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:16: CNTKCommandTrainBegin: train
MPI Rank 3: NDLBuilder Using CPU
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:16: Starting from checkpoint. Loading network from '/tmp/cntk-test-20160405162345.189773/Text_SparseDSSM@release_cpu/Models/dssm.net.2'.
MPI Rank 3: 
MPI Rank 3: Post-processing network...
MPI Rank 3: 
MPI Rank 3: 2 roots:
MPI Rank 3: 	CE = CrossEntropyWithSoftmax()
MPI Rank 3: 	SIM = CosDistanceWithNegativeSamples()
MPI Rank 3: 
MPI Rank 3: Validating network. 21 nodes to process in pass 1.
MPI Rank 3: 
MPI Rank 3: 
MPI Rank 3: Validating network. 11 nodes to process in pass 2.
MPI Rank 3: 
MPI Rank 3: 
MPI Rank 3: Validating network, final pass.
MPI Rank 3: 
MPI Rank 3: Validating --> DSSMLabel = InputValue() :  -> [51 x 1 x *]
MPI Rank 3: Validating --> G = LearnableParameter() :  -> [1 x 1]
MPI Rank 3: Validating --> WQ1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 3: Validating --> WQ0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 3: Validating --> Query = SparseInputValue() :  -> [49292 x *]
MPI Rank 3: Validating --> WQ0_Q = Times (WQ0, Query) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 3: Validating --> WQ0_Q_Tanh = Tanh (WQ0_Q) : [288 x *] -> [288 x *]
MPI Rank 3: Validating --> WQ1_Q = Times (WQ1, WQ0_Q_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 3: Validating --> WQ1_Q_Tanh = Tanh (WQ1_Q) : [64 x *] -> [64 x *]
MPI Rank 3: Validating --> WD1 = LearnableParameter() :  -> [64 x 288]
MPI Rank 3: Validating --> WD0 = LearnableParameter() :  -> [288 x 49292]
MPI Rank 3: Validating --> Keyword = SparseInputValue() :  -> [49292 x *]
MPI Rank 3: Validating --> WD0_D = Times (WD0, Keyword) : [288 x 49292], [49292 x *] -> [288 x *]
MPI Rank 3: Validating --> WD0_D_Tanh = Tanh (WD0_D) : [288 x *] -> [288 x *]
MPI Rank 3: Validating --> WD1_D = Times (WD1, WD0_D_Tanh) : [64 x 288], [288 x *] -> [64 x *]
MPI Rank 3: Validating --> WD1_D_Tanh = Tanh (WD1_D) : [64 x *] -> [64 x *]
MPI Rank 3: Validating --> S = LearnableParameter() :  -> [1 x 1]
MPI Rank 3: Validating --> N = LearnableParameter() :  -> [1 x 1]
MPI Rank 3: Validating --> SIM = CosDistanceWithNegativeSamples (WQ1_Q_Tanh, WD1_D_Tanh, S, N) : [64 x *], [64 x *], [1 x 1], [1 x 1] -> [51 x *]
MPI Rank 3: Validating --> SIM_Scale = ElementTimes (G, SIM) : [1 x 1], [51 x *] -> [51 x 1 x *]
MPI Rank 3: Validating --> CE = CrossEntropyWithSoftmax (DSSMLabel, SIM_Scale) : [51 x 1 x *], [51 x 1 x *] -> [1]
MPI Rank 3: 
MPI Rank 3: 
MPI Rank 3: 8 out of 21 nodes do not share the minibatch layout with the input data.
MPI Rank 3: 
MPI Rank 3: Post-processing network complete.
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:17: Loaded model with 21 nodes on CPU.
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:17: Training criterion node(s):
MPI Rank 3: 04/05/2016 16:25:17: 	CE = CrossEntropyWithSoftmax
MPI Rank 3: 
MPI Rank 3: 
MPI Rank 3: Allocating matrices for forward and/or backward propagation.
MPI Rank 3: 04/05/2016 16:25:17: No PreCompute nodes found, skipping PreCompute step.
MPI Rank 3: 04/05/2016 16:25:17: Warning: checkpoint file is missing. learning parameters will be initialized from 0
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:17: Starting Epoch 3: learning rate per sample = 0.000100  effective momentum = 0.900000  momentum as time constant = 38876.0 samples
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:18: Starting minibatch loop, distributed reading is ENABLED.
MPI Rank 3: 04/05/2016 16:25:25:  Epoch[ 3 of 3]-Minibatch[   1-  10, 40.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.77171040; TotalTime = 7.1541s; SamplesPerSecond = 1431.3
MPI Rank 3: 04/05/2016 16:25:31:  Epoch[ 3 of 3]-Minibatch[  11-  20, 80.00%]: SamplesSeen = 10240; TrainLossPerSample =  1.79679737; TotalTime = 6.3966s; SamplesPerSecond = 1600.8
MPI Rank 3: 04/05/2016 16:25:34: Finished Epoch[ 3 of 3]: [Training Set] TrainLossPerSample = 1.8025136; TotalSamplesSeen = 102399; AvgLearningRatePerSample = 9.9999997e-05; EpochTime=16.5364
MPI Rank 3: Final Results: Minibatch[1-25]: SamplesSeen = 409596    CE: CrossEntropyWithSoftmax/Sample = 1.7629802    Perplexity = 5.8297857    
MPI Rank 3: 04/05/2016 16:25:44: Finished Epoch[ 3 of 3]: [Validation Set] TrainLossPerSample = 1.7629802
MPI Rank 3: 04/05/2016 16:25:47: CNTKCommandTrainEnd: train
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:47: Action "train" complete.
MPI Rank 3: 
MPI Rank 3: 04/05/2016 16:25:47: __COMPLETED__
MPI Rank 3: ~MPIWrapper
